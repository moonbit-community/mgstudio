{"id":"moon-game-studio-02f","title":"moon test: mgstudio-cli blackbox_test C build fails (use-before-declare to_string)","description":"Repro: in mgstudio-cli, run 'moon test'. Build fails compiling main.blackbox_test.c with an error like: to_string undeclared (used before declaration).\n\nThe generated C contains an assignment like '_closure$...-\u003e/bin/zsh = to_string;' before the declaration 'struct ...* to_string;'.\n\nLikely a MoonBit C backend ordering/hoisting bug triggered by the huge combined blackbox test build for a main package.\n\nImpact: moon check and moon build --release pass, but moon test fails.\n\nNext steps: minimize repro and report upstream; consider moving CLI logic into a non-main library package to reduce blackbox test size or disable blackbox tests if supported.","status":"open","priority":2,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-30T23:20:19.398009+08:00","created_by":"Milky2018","updated_at":"2026-01-30T23:20:19.398009+08:00"}
{"id":"moon-game-studio-0dw","title":"Native runtime: refactor to library (CLI links runtime; no separate exe)","status":"in_progress","priority":1,"issue_type":"task","assignee":"Milky2018","created_at":"2026-01-30T11:31:04.682809+08:00","updated_at":"2026-01-30T11:31:14.258053+08:00","labels":["cli","native","refactor","runtime"]}
{"id":"moon-game-studio-0gu","title":"Native runtime window: support resize + update CAMetalLayer drawableSize","description":"Add resize support to mgstudio-runtime-native/window (macOS):\\n- Allow resizable style mask\\n- Track content size changes and expose updated width/height\\n- Update attached CAMetalLayer drawableSize/contentsScale accordingly\\n- Wire into mgstudio_host window_get_width/height/scale_factor","notes":"2026-01-28: Implementing resize metrics sync + CAMetalLayer contentsScale/drawableSize update; also host ensures surface reconfigure before begin_frame.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T15:42:26.967694+08:00","created_by":"Milky2018","updated_at":"2026-01-28T16:01:25.421758+08:00","closed_at":"2026-01-28T16:01:25.421758+08:00","close_reason":"implemented"}
{"id":"moon-game-studio-0jj","title":"Implement Mesh2d rectangle shape","description":"Extend Mesh2d to support Rectangle mesh generation in host + render2d.","notes":"Added Rectangle mesh creation and mesh2d example; build and moon check passed. Pending browser verification tracked in moon-game-studio-ukx.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T13:53:06.435815+08:00","created_by":"Milky2018","updated_at":"2026-01-21T14:02:21.213776+08:00","closed_at":"2026-01-21T14:02:21.213778+08:00"}
{"id":"moon-game-studio-0lf","title":"Implement pixel_grid_snap example","description":"Implement pixel_grid_snap example (simplified for current engine: snap sprite to pixel grid without render-to-texture). Confirm design divergence from Bevy; hook to runner + menu; update .private docs after browser verification.","notes":"Implemented bevy-aligned pixel_grid_snap with render targets, layers, and mesh; docs updated.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T12:42:28.506716+08:00","created_by":"Milky2018","updated_at":"2026-01-21T14:02:00.739875+08:00","closed_at":"2026-01-21T14:02:00.739877+08:00"}
{"id":"moon-game-studio-0pl","title":"CLI: add --assets-source/--data-source and pass config to runtime (native/web)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-30T12:45:41.642576+08:00","updated_at":"2026-01-30T13:34:59.594727+08:00","closed_at":"2026-01-30T13:34:59.594727+08:00","close_reason":"Closed","labels":["assets","cli","data","run"],"dependencies":[{"issue_id":"moon-game-studio-0pl","depends_on_id":"moon-game-studio-rog","type":"parent-child","created_at":"2026-01-30T12:48:07.807075+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-0q9","title":"Cleanup: remove vendored mgstudio-runtime/native/wgpu_mbt directory (now using registry dep)","description":"mgstudio-runtime/native 已切到 wgpu_mbt registry 版本后，仓库里还残留一个旧的 vendored 完整项目目录：mgstudio-runtime/native/wgpu_mbt。\n\n目标：\n- 评估是否需要保留（例如做 patch/对照），否则从仓库中移除或改成 submodule/subtree。\n- 确认不会影响 moon 依赖解析与构建。","notes":"已清理：从仓库移除 vendored 目录 mgstudio-runtime/native/wgpu_mbt（依赖已使用 registry Milky2018/wgpu_mbt@0.2.1）。","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-30T14:11:07.368265+08:00","updated_at":"2026-01-30T14:36:22.35777+08:00","closed_at":"2026-01-30T14:36:22.357773+08:00","labels":["cleanup","deps","native"]}
{"id":"moon-game-studio-160","title":"Web runtime: assets via fetch(base+path), data via IndexedDB (idb:\u003cns\u003e)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-30T12:46:18.344398+08:00","updated_at":"2026-01-30T13:34:59.581976+08:00","closed_at":"2026-01-30T13:34:59.581976+08:00","close_reason":"Closed","labels":["assets","data","runtime","web"],"dependencies":[{"issue_id":"moon-game-studio-160","depends_on_id":"moon-game-studio-rog","type":"parent-child","created_at":"2026-01-30T12:48:07.971439+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-1b0","title":"Text pipeline perf: bulk font-bytes fetch + bulk bytes uploads (avoid per-byte host calls)","description":"Current engine-driven swash pipeline transfers font bytes (host-\u003eengine) and glyph RGBA bytes (engine-\u003ehost) via per-byte calls. This is correct but can be slow for large fonts and frequent glyph uploads.\\n\\nScope:\\n- Add chunked APIs to mgstudio_host, e.g.:\\n  - asset_font_bytes_get_u32(font_id, offset) -\u003e Int (packs 4 bytes)\\n  - bytes_sink_push_u32(word) or bytes_sink_push_bytes(ptr,len) if linear memory is available\\n- Update engine helpers to use chunked transfers.\\n- Add basic perf sanity checks (e.g. avoid O(n^2) concatenations / allocations).\\n\\nAcceptance:\\n- Font load time and first text layout time significantly reduced vs per-byte baseline.\\n- No behavior change.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-31T17:14:29.894446+08:00","created_by":"Milky2018","updated_at":"2026-01-31T17:14:29.894446+08:00"}
{"id":"moon-game-studio-1b1","title":"mgstudio-yazi: port upstream streaming deflate encoder (DeflateContext/Dictionary/CodeBuffer)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-23T11:07:18.798309+08:00","updated_at":"2026-01-23T11:59:43.072139+08:00","closed_at":"2026-01-23T11:59:43.072139+08:00","close_reason":"Closed","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-1b1","depends_on_id":"moon-game-studio-i0b.1.5","type":"parent-child","created_at":"2026-01-23T11:07:41.229589+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-1b1.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Starting upstream parity: streaming encoder core","status":"closed","priority":4,"issue_type":"event","created_at":"2026-01-23T11:08:03.160018+08:00","created_by":"Milky2018","updated_at":"2026-01-23T11:08:03.160018+08:00","closed_at":"2026-01-23T11:08:04.160018+08:00","dependencies":[{"issue_id":"moon-game-studio-1b1.1","depends_on_id":"moon-game-studio-1b1","type":"parent-child","created_at":"2026-01-23T11:08:03.160703+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-1bp","title":"Align user-change propagation with rapier (colliders/joints)","description":"Port rapier/pipeline/user_changes: handle rigid-body changes propagating to colliders/joints, add ModifiedColliders/ColliderChanges tracking, and update pipeline clear/propagate flow.","notes":"Implemented collider/joint user-change propagation: collider enable state + modified tracking, parent enable propagation, mass-prop change marking, pipeline handling; updated specs/mbti; moon info/fmt/check + tests (dynamics, pipeline) pass.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T16:50:44.292914+08:00","created_by":"Milky2018","updated_at":"2026-01-22T17:38:08.513893+08:00","closed_at":"2026-01-22T17:38:08.513896+08:00"}
{"id":"moon-game-studio-1hp","title":"WASM entrypoints: always export mgstudio_host_string_to_js for Web fallback","description":"Web host fallback (for browsers that expose wasm-gc refs as opaque objects) requires guest export mgstudio_host_string_to_js(text:String)-\u003eUnit. Ensure all standard entrypoint packages include this export in link.wasm-gc.exports, or centralize it in a shared entry package/template.\\n\\nAcceptance:\\n- New game/entry packages include the export by default.\\n- Web runtime can load assets in an environment where String refs are opaque.\\n","status":"open","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-23T16:32:45.107521+08:00","created_by":"Milky2018","updated_at":"2026-01-23T16:32:45.107521+08:00"}
{"id":"moon-game-studio-1lk","title":"Fix WebGPU render target format mismatch","description":"Render target textures use rgba8unorm while pipeline uses swapchain format (bgra8unorm), causing pass/pipeline mismatch in mesh2d/pixel_grid_snap.","notes":"Use swapchain format for render targets in host.js to match pipeline attachment format.","status":"closed","priority":1,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-21T14:07:31.148669+08:00","created_by":"Milky2018","updated_at":"2026-01-21T14:07:38.727392+08:00","closed_at":"2026-01-21T14:07:38.727395+08:00"}
{"id":"moon-game-studio-1r4","title":"Native runtime: runner exports trap (unreachable) with stubbed mgstudio_host","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-25T18:34:17.085427+08:00","updated_at":"2026-01-26T09:31:16.197341+08:00","closed_at":"2026-01-26T09:31:16.197341+08:00","close_reason":"Fixed by returning non-null externref handles in native host stubs; exports no longer trap.","comments":[{"id":77,"issue_id":"moon-game-studio-1r4","author":"Milky2018","text":"Repro (after bumping to wasmoon 0.1.3):\n- moon run mgstudio-runtime/native/mbt (instantiates runner.wasm ok)\n- moon run mgstudio-runtime/native/mbt ../../../mgstudio-engine/_build/wasm-gc/release/build/examples/runner/runner.wasm run_sprite\nObserved: runtime error: unreachable\n\nLikely cause: host stubs return null/dummy handles for gpu_request_device/gpu_begin_frame/etc; engine code may unwrap/assume non-null and panic.\nNext: improve host stubs to return consistent non-null sentinel externrefs/ids, or make engine tolerate stubbed host for headless bring-up.","created_at":"2026-01-25T10:34:42Z"},{"id":78,"issue_id":"moon-game-studio-1r4","author":"Milky2018","text":"Update: not a wasmoon bug. The trap was caused by native host stubs returning null externref handles (window/device/surface/frame). Returning stable non-null externrefs fixes run_sprite + run_2d_viewport_to_world (both now return normally).","created_at":"2026-01-26T01:31:16Z"}]}
{"id":"moon-game-studio-38v","title":"Port remaining rapier dynamics components","description":"Continue aligning mgstudio_physics dynamics with rapier: add rigid_body_components fields (damping/forces/activation) and solver/integration pieces as needed.","notes":"Added ImpulseJointSet::select_active_interactions aligned with rapier active joint selection; moon info/fmt/check/test ok.","status":"in_progress","priority":2,"issue_type":"task","assignee":"Milky2018","owner":"842376130@qq.com","created_at":"2026-01-22T13:13:27.722534+08:00","created_by":"Milky2018","updated_at":"2026-01-23T10:50:21.020338+08:00","comments":[{"id":11,"issue_id":"moon-game-studio-38v","author":"Milky2018","text":"Added internal RigidBodyIds (active_island_id/active_set_id/active_set_timestamp) and wired IslandManager traversal/indexing to read/update them; removed body_active_timestamps array. Re-ran moon fmt/info/check/test for dynamics.","created_at":"2026-01-22T06:56:10Z"}]}
{"id":"moon-game-studio-38v.1","title":"Align IslandManager sleep traversal with rapier","description":"Audit mgstudio-physics/dynamics/placeholders.mbt IslandManager vs rapier/src/dynamics/island_manager/* (sleep.rs, optimizer.rs). Bring traversal, contact graph handling, and sleep root state transitions to parity with rapier 2D semantics.","notes":"Blocked by collision-\u003edynamics import cycle; island manager cannot depend on collision without refactor. Keep ContactGraph until dependency split or shared core.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:36:24.244474+08:00","created_by":"Milky2018","updated_at":"2026-01-23T11:44:21.874527+08:00","closed_at":"2026-01-23T11:44:21.874527+08:00","close_reason":"Closed","dependencies":[{"issue_id":"moon-game-studio-38v.1","depends_on_id":"moon-game-studio-38v","type":"parent-child","created_at":"2026-01-22T19:36:24.245269+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-3k5","title":"Native runtime: implement font loading + glyph rasterization for Text2d","description":"Implement mgstudio_host font APIs in mgstudio-runtime/native.\n\nScope:\n- asset_load_font(path_id) -\u003e font_id: read TTF/OTF from assets and keep in a host font table\n- font_rasterize_glyph(font_id, font_size, codepoint, smoothing) -\u003e glyph_id: rasterize to alpha bitmap\n- font_glyph_width/height/offset_x/offset_y and font_measure_advance must return correct values\n\nNotes:\n- Likely implement via stb_truetype (C stub) or CoreText (macOS).\n- Must follow existing engine contract in mgstudio-engine/text/font_atlas.mbt.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T18:28:52.331715+08:00","created_by":"Milky2018","updated_at":"2026-01-31T17:13:55.458813+08:00","closed_at":"2026-01-31T17:13:55.458813+08:00","close_reason":"Superseded: font metrics/rasterization moved into engine via moon_swash; native host now provides asset_load_font + font bytes access instead of font_* raster APIs."}
{"id":"moon-game-studio-4bo","title":"Align RigidBodyType and handle API with rapier","description":"Add KinematicVelocityBased body type, handle raw parts helpers, and related builder/tests for mgstudio_physics dynamics.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T13:09:31.221828+08:00","created_by":"Milky2018","updated_at":"2026-01-22T13:12:34.777327+08:00","closed_at":"2026-01-22T13:12:34.777327+08:00","close_reason":"done"}
{"id":"moon-game-studio-4f9","title":"Native runtime: replace sys.exit() fatal paths with structured error propagation","description":"Problem:\n- wgpu_backend.mbt uses @sys.exit(1) via fatal() for unrecoverable errors (e.g. missing builtin shaders).\n- This is acceptable short-term but makes the backend hard to embed/test and bypasses error reporting.\n\nGoal:\n- Introduce a dedicated error type (suberror) for native runtime fatal errors and propagate it through the call stack (or trap in host funcs) instead of exiting the process directly.\n\nNotes:\n- Keep the behavior fail-fast; just improve error plumbing.","status":"open","priority":3,"issue_type":"task","created_at":"2026-02-01T18:55:14.387401+08:00","updated_at":"2026-02-01T18:55:24.56621+08:00"}
{"id":"moon-game-studio-4je","title":"Native runtime: implement dir:\u003cpath\u003e for assets/data (filesystem)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-30T12:46:32.507732+08:00","updated_at":"2026-01-30T13:34:59.569411+08:00","closed_at":"2026-01-30T13:34:59.569411+08:00","close_reason":"Closed","labels":["assets","data","native","runtime"],"dependencies":[{"issue_id":"moon-game-studio-4je","depends_on_id":"moon-game-studio-rog","type":"parent-child","created_at":"2026-01-30T12:48:08.052242+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-4k7","title":"Engine text: use cosmic CacheKey subpixel bins for atlas caching","description":"Align FontAtlas cache key with cosmic-text CacheKey (x_bin/y_bin) to improve subpixel layout + glyph atlas cache hit rate and match bevy behavior. Requires passing subpixel offsets into swash rasterization.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-31T20:35:08.409803+08:00","created_by":"Milky2018","updated_at":"2026-01-31T20:35:08.409803+08:00"}
{"id":"moon-game-studio-4lk","title":"Migrate web runtime host to MoonBit WebGPU FFI","description":"Port mgstudio-runtime/web host runtime from JS to MoonBit, add WebGPU FFI subpackage, and wire loader to use MoonBit host.","status":"closed","priority":2,"issue_type":"task","assignee":"Milky2018","owner":"842376130@qq.com","created_at":"2026-01-21T18:31:32.932017+08:00","created_by":"Milky2018","updated_at":"2026-01-26T17:32:19.9262+08:00","closed_at":"2026-01-26T17:32:19.9262+08:00","close_reason":"Closed","comments":[{"id":1,"issue_id":"moon-game-studio-4lk","author":"Milky2018","text":"Fix wasm:js-string imports for use-js-builtin-string by providing length/charCodeAt/concat/fromCharCodeArray in web runtime.","created_at":"2026-01-22T02:40:45Z"},{"id":2,"issue_id":"moon-game-studio-4lk","author":"Milky2018","text":"Handle js-string fromCharCodeArray for array.get + array indexing + typed-array/ArrayBuffer fallback to fix wasm-gc string import runtime.","created_at":"2026-01-22T02:44:01Z"},{"id":3,"issue_id":"moon-game-studio-4lk","author":"Milky2018","text":"Root cause: fromCharCodeArray receives wasm GC arrayref; must use WebAssembly.String.fromCharCodeArray (or WebAssembly.Array.get) instead of treating it like JS array.","created_at":"2026-01-22T02:47:46Z"},{"id":4,"issue_id":"moon-game-studio-4lk","author":"Milky2018","text":"Switch wasm instantiation to JS String builtins (builtins: [\"js-string\"]) and remove manual wasm:js-string imports.","created_at":"2026-01-22T02:54:02Z"}]}
{"id":"moon-game-studio-4uy","title":"Native runtime: finalize JIT lifecycle (teardown + free globals)","description":"- Ensure @jit.gc_teardown runs on shutdown/exit paths\\n- Track and free globals buffer allocated by @jit.alloc_memory in mgstudio-runtime/native/jit_exec.mbt\\n- Confirm store tables allocate JIT tables (store.get_jit_table != None) for call_indirect-heavy workloads; add a smoke test when we have a minimal wasm fixture\\n","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-02-01T12:52:30.582861+08:00","created_by":"Milky2018","updated_at":"2026-02-01T12:52:30.582861+08:00"}
{"id":"moon-game-studio-526","title":"Implement mgstudio_physics collision/query/pipeline/control APIs and unskip tests","description":"Implement collision, query, pipeline, and control APIs (replace #declaration_only) and unskip related tests.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T19:45:43.386227+08:00","created_by":"Milky2018","updated_at":"2026-01-22T09:06:51.638668+08:00","closed_at":"2026-01-22T09:06:51.638668+08:00","close_reason":"Closed","labels":["status:in_progress"]}
{"id":"moon-game-studio-526.1","title":"State change: status → in_progress","description":"Set status to in_progress","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-21T20:26:07.103912+08:00","created_by":"Milky2018","updated_at":"2026-01-21T20:26:07.103912+08:00","dependencies":[{"issue_id":"moon-game-studio-526.1","depends_on_id":"moon-game-studio-526","type":"parent-child","created_at":"2026-01-21T20:26:07.104548+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-5e5","title":"Native sprite: rotation distorts with window aspect ratio (rotate in NDC with non-uniform scaling)","description":"In native runtime sprite pipeline, we currently scale to NDC and then rotate in NDC. Because viewport transform is anisotropic (x scaled by width, y by height), rotating in NDC produces aspect-ratio dependent distortion: square sprites become squashed when window is wide/short.","acceptance_criteria":"- Rotating sprite stays undistorted (square remains square) regardless of window aspect ratio\\n- Verified with examples/2d/rotation in native runtime","notes":"Follow-up fix: sprite uniform pack size was 72 bytes after aspect-ratio shader change but UBO is 64 bytes; removed extra padding floats so pack matches WGSL (16 floats / 64 bytes). This likely caused blank screen.","status":"open","priority":1,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-29T14:41:36.859869+08:00","created_by":"Milky2018","updated_at":"2026-01-29T14:49:22.721218+08:00"}
{"id":"moon-game-studio-5q5","title":"CLI: remove -P platform; add run(native)/serve(web) commands","description":"目标：去掉 -P/--platform\n- mgstudio run \u003cwasm\u003e 仅本地(native)运行\n- mgstudio serve \u003cwasm\u003e 启动 web server 并在浏览器运行\n并调整 assets-source/data-source 在 serve 场景的映射（dir: -\u003e served url base），以及去掉 run/serve 与 gen 的耦合。\n\n验收：\n- ./mgstudio run --help 与 ./mgstudio serve --help 符合预期\n- ./mgstudio run \u003cwasm\u003e 不再出现 platform 相关参数\n- ./mgstudio serve \u003cwasm\u003e 输出可访问 URL，assets-source 可用 dir: 目录并自动挂载\n- moon check / moon test 通过","notes":"已完成：\n- 去掉 run 的 --platform/-P（native 仅用 run）\n- 新增 serve 子命令（web）\n- serve 使用 ./.mgstudio/serve 进行 staging，不再污染 runtime 模板目录\n- serve 支持 assets-source=dir:\u003cpath\u003e 或本地目录自动挂载为 ./_mgstudio_assets/ 并传给 web runtime\n- run/serve 不再调用 gen\n\n已验证：\n- ./mgstudio run --help / serve --help\n- moon check -C mgstudio-cli","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-30T13:42:34.619751+08:00","updated_at":"2026-01-30T13:53:54.010112+08:00","closed_at":"2026-01-30T13:53:54.010114+08:00","labels":["breaking","cli","native","run","web"]}
{"id":"moon-game-studio-66w","title":"Integrate joint wake/join queues in physics pipeline","description":"Add take_wake_up/to_join APIs for joint sets and consume them in PhysicsPipeline::step to wake bodies and join islands per rapier.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T10:55:32.411555+08:00","created_by":"Milky2018","updated_at":"2026-01-22T10:59:14.436761+08:00","closed_at":"2026-01-22T10:59:14.436761+08:00","close_reason":"done"}
{"id":"moon-game-studio-6b5","title":"Implement GizmoConfig + line style config","description":"Add Bevy-aligned GizmoConfig/GizmoLineConfig types and apply line width/style (solid/dotted/dashed) in web gizmo pipeline.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T12:53:13.545009+08:00","created_by":"Milky2018","updated_at":"2026-01-22T12:53:13.545009+08:00","labels":["status:done","status:in_progress"],"comments":[{"id":9,"issue_id":"moon-game-studio-6b5","author":"Milky2018","text":"Added GizmoConfig/GizmoLineConfig/GizmoLineStyle/GizmoLineJoint types + gizmo_config setters, applied config line width/style (solid/dotted/dashed) via host gizmo pipeline; host_gpu_draw_gizmo_line now carries width/style params. Line joints are stored in config but not yet applied in rendering (currently behaves like None).","created_at":"2026-01-22T05:01:43Z"}]}
{"id":"moon-game-studio-6b5.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Start implementing GizmoConfig + line style","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-22T12:53:20.336704+08:00","created_by":"Milky2018","updated_at":"2026-01-22T12:53:20.336704+08:00","dependencies":[{"issue_id":"moon-game-studio-6b5.1","depends_on_id":"moon-game-studio-6b5","type":"parent-child","created_at":"2026-01-22T12:53:20.337633+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-6b5.2","title":"State change: status → done","description":"Changed status from in_progress to done\n\nReason: GizmoConfig + line style implemented; line joints not yet rendered (default None).","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-22T13:01:52.396558+08:00","created_by":"Milky2018","updated_at":"2026-01-22T13:01:52.396558+08:00","dependencies":[{"issue_id":"moon-game-studio-6b5.2","depends_on_id":"moon-game-studio-6b5","type":"parent-child","created_at":"2026-01-22T13:01:52.397213+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-6dd","title":"Web/Native runtime: add wasm-gc String (array i16) encode/decode utilities","description":"Implement robust conversion between MoonBit wasm-gc String (array of i16 UTF-16 code units) and host strings.\n\nScope:\n- Web host: decode string params reliably (WebAssembly.Array / polyfills), and implement encoding for host functions that return String.\n- Native host (wasmoon): decode/encode using wasmoon GC heap primitives.\n- Update mgstudio_host APIs that currently return String (e.g. font_rasterize_glyph, folder event polling) to use the new helpers, or redesign APIs to avoid returning String.\n\nAcceptance:\n- End-to-end Text2d path that requires host string returns works in both Web and Native.\n- No js-string builtin / imported string constants anywhere in the wasm build.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-23T15:39:00.199834+08:00","created_by":"Milky2018","updated_at":"2026-01-28T18:27:46.614188+08:00","closed_at":"2026-01-28T18:27:46.614188+08:00","close_reason":"Superseded by host string-handle ABI (string_sink_* + Int handles); no JS wasm-gc string decode required."}
{"id":"moon-game-studio-6vh","title":"Implement Gizmos (Bevy-aligned) for 2D examples","description":"Provide Gizmos API compatible with bevy::gizmos used in 2d_viewport_to_world, including shape drawing, batching, and render2d integration.","notes":"Add design in .private/docs/engine and confirm before implementation.","status":"in_progress","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T11:08:01.278304+08:00","created_by":"Milky2018","updated_at":"2026-01-22T11:08:07.360284+08:00","labels":["status:done"],"comments":[{"id":5,"issue_id":"moon-game-studio-6vh","author":"Milky2018","text":"Drafted .private/docs/engine/GIZMO.md with Bevy-aligned 2D Gizmo API + pipeline plan; awaiting confirmation on global gizmos API and line width strategy.","created_at":"2026-01-22T03:13:21Z"},{"id":6,"issue_id":"moon-game-studio-6vh","author":"Milky2018","text":"Implemented Gizmos API + builder support (ellipses/arcs/rounded-rect/arrows/grid), added per-pass line rendering via WebGPU pipeline + gizmo shader, updated viewport_to_world to use Gizmos, and synced .private/docs/engine/GIZMO.md. Browser validation pending (expect circles/lines to render).","created_at":"2026-01-22T04:25:53Z"},{"id":8,"issue_id":"moon-game-studio-6vh","author":"Milky2018","text":"Implemented Bevy-aligned 2D Gizmos (lines/rect/circle/ellipse/arc/rounded-rect/arrow/axes/cross/grid/curve), SystemParam get, render2d integration, host draw API, and gizmo shader; moon check passes for mgstudio-engine + mgstudio-runtime/web/mbt. Browser validation still pending.","created_at":"2026-01-22T04:32:43Z"}]}
{"id":"moon-game-studio-6vh.1","title":"State change: status → done","description":"Set status to done\n\nReason: Gizmos implementation complete; browser validation pending.","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-22T12:32:50.9819+08:00","created_by":"Milky2018","updated_at":"2026-01-22T12:32:50.9819+08:00","dependencies":[{"issue_id":"moon-game-studio-6vh.1","depends_on_id":"moon-game-studio-6vh","type":"parent-child","created_at":"2026-01-22T12:32:50.98258+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-6w5","title":"Tidy mgstudio_physics core imports and deprecated string APIs","description":"Add missing core imports (math/strconv) in moon.pkg.json and replace deprecated string helpers in serialization code.","status":"open","priority":3,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T19:45:57.518731+08:00","created_by":"Milky2018","updated_at":"2026-01-21T19:46:38.90174+08:00","labels":["status:done","status:in_progress"]}
{"id":"moon-game-studio-6w5.2","title":"State change: status → done","description":"Changed status from in_progress to done","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-21T20:20:16.654313+08:00","created_by":"Milky2018","updated_at":"2026-01-21T20:20:16.654313+08:00","dependencies":[{"issue_id":"moon-game-studio-6w5.2","depends_on_id":"moon-game-studio-6w5","type":"parent-child","created_at":"2026-01-21T20:20:16.655076+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-761","title":"Native runtime: implement gpu_create_mesh_triangles (Mesh2dGeometry)","description":"Implement mgstudio_host.gpu_create_mesh_triangles in mgstudio-runtime/native.\n\nScope:\n- Decode vertices_xy CSV (from Mesh2dGeometry.encode_triangle_positions_csv)\n- Build index buffer and store mesh info so gpu_draw_mesh can render it\n\nAcceptance:\n- examples/2d/mesh2d runs in native runtime without traps.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T18:28:57.552661+08:00","created_by":"Milky2018","updated_at":"2026-01-29T09:13:44.29864+08:00","closed_at":"2026-01-29T09:13:44.29864+08:00","close_reason":"Implemented gpu_create_mesh_triangles in native runtime (CSV decode + mesh upload)"}
{"id":"moon-game-studio-7q4","title":"app: generic App[W] + System[W] execution (no global World)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-27T14:44:06.26005+08:00","updated_at":"2026-01-27T15:38:11.567776+08:00","closed_at":"2026-01-27T15:38:11.567776+08:00","close_reason":"Closed","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-7q4","depends_on_id":"moon-game-studio-v7g","type":"blocks","created_at":"2026-01-27T14:44:16.371128+08:00","created_by":"Milky2018"}],"comments":[{"id":92,"issue_id":"moon-game-studio-7q4","author":"Milky2018","text":"Design drafted: .private/docs/engine/APP_GENERIC_WORLD.md (App[W] + SystemFn[W] without global World). Next: refactor mgstudio-engine/app to generic App[W] and wire schedule to run systems with world param.","created_at":"2026-01-27T06:45:22Z"},{"id":94,"issue_id":"moon-game-studio-7q4","author":"Milky2018","text":"Refactored mgstudio-engine/app to generic  +  execution; schedule now runs systems with world arg (no global World). Updated built-in plugins (window/time/asset/input/render2d/text/diagnostics) and 2D examples to pass a concrete world ().","created_at":"2026-01-27T07:36:32Z"},{"id":97,"issue_id":"moon-game-studio-7q4","author":"Milky2018","text":"Refactored mgstudio-engine/app to generic App[W] + SystemFn[W]=(W)-\u003eUnit execution; schedule now runs systems with world arg (no global World). Updated built-in plugins (window/time/asset/input/render2d/text/diagnostics) and 2D examples to pass a concrete world (ecs_world.World).","created_at":"2026-01-27T07:36:50Z"}]}
{"id":"moon-game-studio-7sg","title":"Gen: run moonfmt only on generated files after mgstudio gen","status":"closed","priority":2,"issue_type":"task","assignee":"Milky2018","created_at":"2026-01-29T15:46:40.544125+08:00","updated_at":"2026-01-30T10:59:35.876023+08:00","closed_at":"2026-01-30T10:59:35.876023+08:00","close_reason":"Closed","labels":["fmt","gen"]}
{"id":"moon-game-studio-88m","title":"Add WebGPU FFI subpackage (mgstudio-runtime/web/mbt/webgpu)","notes":"Added webgpu subpackage with minimal WebGPU FFI + constants and integrated into runtime (preferred format log).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-21T17:48:44.957639+08:00","updated_at":"2026-01-21T17:52:15.028272+08:00","closed_at":"2026-01-21T17:52:15.028275+08:00"}
{"id":"moon-game-studio-8zd","title":"Align island optimizer limits and boundary tests","description":"Add additional solver iteration tracking for islands and expand island merge/split tests.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T12:40:44.369788+08:00","created_by":"Milky2018","updated_at":"2026-01-22T12:53:30.794612+08:00","closed_at":"2026-01-22T12:53:30.794612+08:00","close_reason":"done"}
{"id":"moon-game-studio-953","title":"wasmoon 0.1.2: parser fails on MoonBit wasm-gc output (rec groups forward refs) with invalid heap type","description":"Repro:\\n- Build: mgstudio-engine/_build/wasm-gc/release/build/examples/runner/runner.wasm (MoonBit wasm-gc output)\\n- In mgstudio-runtime/native/mbt (new PoC), run: moon run . ../../../mgstudio-engine/_build/wasm-gc/release/build/examples/runner/runner.wasm run_sprite\\n- Observed: ParserError: invalid heap type\\n\\nDiagnosis:\\n- wasmoon/parser Parser::read_rec_group pushes subtypes to self.types incrementally; resolve_heap_type_as_ref_value_type rejects typed refs to type indices that are not yet in self.types.\\n- MoonBit emits rec groups where earlier types reference later types inside the same rec group (forward refs), which is valid per WasmGC.\\n- Example from wasm-tools print: (rec (type (;12;) (func (param (ref 13)) (result i32))) (type (;13;) (sub (struct ...))))\\n\\nAcceptance:\\n- wasmoon can parse/instantiate MoonBit wasm-gc modules containing rec groups with forward references.\\n- Add a regression test using a minimal wasm with such a rec group.\\n","notes":"Filed upstream: https://github.com/Milky2018/wasmoon/issues/344","status":"closed","priority":0,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-23T17:01:40.942584+08:00","created_by":"Milky2018","updated_at":"2026-01-25T18:34:09.167196+08:00","closed_at":"2026-01-25T18:34:09.167196+08:00","close_reason":"Resolved in Milky2018/wasmoon \u003e= 0.1.3 (gh-344).","external_ref":"gh-344","comments":[{"id":76,"issue_id":"moon-game-studio-953","author":"Milky2018","text":"Update: wasmoon 0.1.3 fixes the rec-group forward reference parse bug (gh-344, PR #345). mgstudio-runtime/native can now parse+instantiate runner.wasm; remaining work is implementing real mgstudio_host APIs (current stubs may trap when running examples).","created_at":"2026-01-25T10:34:09Z"}]}
{"id":"moon-game-studio-9gr","title":"Native mesh pipeline: add alpha blending + surface-format-aware pipeline descriptors for pos2","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-01T18:54:50.600503+08:00","updated_at":"2026-02-01T18:54:50.600503+08:00"}
{"id":"moon-game-studio-9si","title":"Web runtime: window_run_loop callback interop TypeError","description":"Web wasm-gc throws TypeError: type incompatibility when transforming from/to JS in window_run_loop -\u003e host_call0_any. Suspect make_closure JS binding for wasm funcref/anyref; adjust make_closure to extern JS with bind fallback and test in browser.","status":"closed","priority":2,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-26T16:45:05.252393+08:00","created_by":"Milky2018","updated_at":"2026-01-26T17:30:13.835686+08:00","closed_at":"2026-01-26T17:30:13.835686+08:00","close_reason":"Closed","comments":[{"id":79,"issue_id":"moon-game-studio-9si","author":"Milky2018","text":"Switch window_run_loop to FuncRef and use a closed tick function stored in RunnerState; updated native host import to accept FuncRef. Please verify in browser.","created_at":"2026-01-26T08:56:37Z"},{"id":80,"issue_id":"moon-game-studio-9si","author":"Milky2018","text":"Root cause: wasm-gc cannot accept host-\u003ewasm String returns without use-js-builtin-string. Replaced folder event/handles APIs to return Ints (asset_poll_loaded_folder_event_kind/id, asset_loaded_folder_handles_len/get) so no JS String crosses into wasm. Also fixed mgstudio-runtime/web/build.sh to rsync engine assets without clobbering runtime shaders. Rebuild web (build.sh) and re-test mesh2d/sprite examples.","created_at":"2026-01-26T09:21:04Z"}]}
{"id":"moon-game-studio-9xr","title":"Native runtime: implement asset_load_folder + folder events","description":"Implement mgstudio_host asset folder loading on native runtime.\n\nScope:\n- asset_load_folder(path_id) -\u003e folder_id reads folder.txt manifest from assets root\n- asset_poll_loaded_folder_event_kind/id and loaded_folder_handles_len/get return consistent events and handles\n\nAcceptance:\n- examples/2d/texture_atlas_builder runs in native runtime.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T18:28:59.967815+08:00","created_by":"Milky2018","updated_at":"2026-01-28T18:28:59.967815+08:00"}
{"id":"moon-game-studio-9yj","title":"Native runtime: implement keyboard/mouse input backend","description":"Implement mgstudio_host input_* in native runtime using Cocoa events:\\n- Maintain per-frame key/button state (down/just_pressed/just_released)\\n- Track cursor position in logical coordinates\\n- Integrate with window_poll_events and input_finish_frame\\n- Add minimal keycode mapping to match mgstudio-engine/input key strings","notes":"2026-01-28: Implementing native input backend using NSEvent parsing in window poll loop; host decodes guest key strings via mgstudio_host_string_to_js + string_sink_push.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T15:42:35.422396+08:00","created_by":"Milky2018","updated_at":"2026-01-28T16:19:12.538019+08:00","closed_at":"2026-01-28T16:19:12.538019+08:00","close_reason":"implemented"}
{"id":"moon-game-studio-a9u","title":"Bevy port: dependency-free core work","description":"Track ongoing Bevy-aligned porting tasks that do not require new third-party libraries (core engine/data-structure work).","acceptance_criteria":"Issues are broken down into concrete, dependency-free tasks with clear acceptance criteria; progress can be tracked via bd parent/child links.","status":"open","priority":1,"issue_type":"epic","owner":"842376130@qq.com","created_at":"2026-01-26T12:28:10.538628+08:00","created_by":"Milky2018","updated_at":"2026-01-26T12:28:10.538628+08:00"}
{"id":"moon-game-studio-a9u.1","title":"Transform: Parent/Children + GlobalTransform propagation (Bevy parity)","description":"Implement hierarchy components and a Bevy-aligned transform propagation system (Local-\u003eGlobal, dirty handling, parent-\u003echild order).","acceptance_criteria":"Entities with Parent/Children + Transform compute correct GlobalTransform; propagation updates only when inputs change; matches Bevy behavior on simple hierarchies.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T12:28:24.266162+08:00","created_by":"Milky2018","updated_at":"2026-01-26T12:54:59.614164+08:00","closed_at":"2026-01-26T12:54:59.614164+08:00","close_reason":"Implemented transform hierarchy store + global propagation w/ update tick + tests","labels":["bevy-parity","engine","transform"],"dependencies":[{"issue_id":"moon-game-studio-a9u.1","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:24.267142+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.10","title":"render2d/transform: migrate to ECS + Visibility propagation","description":"Migrate render2d + transform hierarchy to ECS world, then implement Visibility/InheritedVisibility/ViewVisibility and filter draw.","design":"See .private/docs/engine/VISIBILITY_ECS.md","acceptance_criteria":"- render2d + transform components exist in ECS\\n- propagate_visibility works for parent/child\\n- render2d draw filters by ViewVisibility\\n- Web example toggles visibility","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T19:13:19.196131+08:00","created_by":"Milky2018","updated_at":"2026-01-26T19:13:19.196131+08:00","labels":["status:blocked"],"dependencies":[{"issue_id":"moon-game-studio-a9u.10","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T19:13:19.197327+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-a9u.10","depends_on_id":"moon-game-studio-a9u.9","type":"blocks","created_at":"2026-01-26T19:13:19.198191+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.10.1","title":"State change: status → blocked","description":"Set status to blocked\n\nReason: Blocked on ECS foundation task","status":"closed","priority":4,"issue_type":"event","created_at":"2026-01-26T19:13:29.599095+08:00","created_by":"Milky2018","updated_at":"2026-01-26T19:13:29.599095+08:00","closed_at":"2026-01-26T19:13:30.599095+08:00","dependencies":[{"issue_id":"moon-game-studio-a9u.10.1","depends_on_id":"moon-game-studio-a9u.10","type":"parent-child","created_at":"2026-01-26T19:13:29.599802+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.11","title":"cli: mgstudio-cli (gen)","description":"Create a mgstudio CLI module providing mgstudio gen for mgstudio-specific tags (initially #ecs.component). Must use moonbitlang/async/fs and async/* libs (no moonbitlang/x/fs).","design":"See .private/docs/cli/MGSTUDIO_CLI.md","acceptance_criteria":"- moon build -C mgstudio-cli main --release succeeds and produces mgstudio binary\\n- mgstudio gen --check/--write works on this repo and uses async/fs walk + file IO\\n- Writes per-package ecs.g.mbt deterministically, and --check fails on drift\\n- No imports of moonbitlang/x/fs","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-27T10:43:51.87454+08:00","created_by":"Milky2018","updated_at":"2026-01-27T14:02:32.766679+08:00","closed_at":"2026-01-27T14:02:32.766679+08:00","close_reason":"Closed","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-a9u.11","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-27T10:43:51.87614+08:00","created_by":"Milky2018"}],"comments":[{"id":87,"issue_id":"moon-game-studio-a9u.11","author":"Milky2018","text":"Switched mgstudio-cli gen to AST parsing via moonbitlang/parser. Current parser can\\x27t parse \"type Alias = Type\" in our sources (Unexpected EQUAL), so temporarily use deprecated \"pub typealias Type as Alias\" for type aliases (see .private/docs/cli/PARSER_COMPAT.md). Once parser updates, revert aliases back.","created_at":"2026-01-27T05:41:28Z"},{"id":88,"issue_id":"moon-game-studio-a9u.11","author":"Milky2018","text":"Switched mgstudio-cli to TheWaWaR/clap@0.2.6 for argument parsing (no hand-rolled ArgParser). gen options are now clap-driven; --modules is optional (Nargs::Any); write behavior: default write=true, --check =\u003e write=false, --write overrides.","created_at":"2026-01-27T06:01:24Z"}]}
{"id":"moon-game-studio-a9u.12","title":"ecs: resources + change detection + query API","description":"Extend ECS core to match Bevy semantics beyond codegen World: resources storage, change detection (ticks), and basic query/iteration helpers for system ergonomics.","design":"See bevy/crates/bevy_ecs and follow-up to .private/docs/engine/ECS_FOUNDATION.md","acceptance_criteria":"- Resource storage API (insert/get/remove) without globals\\n- Change detection tick model aligned with Bevy (ComponentTicks / SystemTicks)\\n- Minimal query/iter helpers for SparseSet-backed World (e.g. iter entities with component)\\n- Tests","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-27T15:37:49.625513+08:00","created_by":"Milky2018","updated_at":"2026-01-27T18:28:48.915759+08:00","closed_at":"2026-01-27T18:28:48.915759+08:00","close_reason":"Implemented resources/change ticks/query helpers + scheduler integration; tests passing.","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-a9u.12","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-27T15:37:49.626232+08:00","created_by":"Milky2018"}],"comments":[{"id":100,"issue_id":"moon-game-studio-a9u.12","author":"Milky2018","text":"Proposed and implemented DefaultPlugins-style helper in top-level mgstudio package (no globals) to reduce example boilerplate. Design recorded in .private/docs/engine/DEFAULT_PLUGINS.md.","created_at":"2026-01-27T08:18:56Z"}]}
{"id":"moon-game-studio-a9u.12.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Start implementation","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-27T16:26:52.670426+08:00","created_by":"Milky2018","updated_at":"2026-01-27T16:26:52.670426+08:00","dependencies":[{"issue_id":"moon-game-studio-a9u.12.1","depends_on_id":"moon-game-studio-a9u.12","type":"parent-child","created_at":"2026-01-27T16:26:52.671247+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.13","title":"ecs: add core component set (transform/hierarchy/visibility) + grow ecs_world","description":"Tag and/or introduce Bevy-parity core components (Parent/Children/GlobalTransform/Visibility etc) and ensure ecs_world codegen includes them so downstream ECS migration is unblocked.","design":"Follow ./bevy (bevy_transform, bevy_hierarchy, visibility). See .private/docs/engine/ECS_CODEGEN_WORLD.md","acceptance_criteria":"- Parent/Children/GlobalTransform/Visibility components exist and are #ecs.component\\n- mgstudio gen produces ecs_world with these component stores\\n- mgstudio gen -c passes after moon fmt\\n- mgstudio-engine check/test pass","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-27T16:26:16.14726+08:00","created_by":"Milky2018","updated_at":"2026-01-27T18:28:49.006838+08:00","closed_at":"2026-01-27T18:28:49.006838+08:00","close_reason":"Added #ecs.component core set (Parent/Children/GlobalTransform/Visibility) and regenerated ecs_world; engine check/test pass.","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-a9u.13","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-27T16:26:16.148018+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.13.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Start component expansion","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-27T16:26:52.771018+08:00","created_by":"Milky2018","updated_at":"2026-01-27T16:26:52.771018+08:00","dependencies":[{"issue_id":"moon-game-studio-a9u.13.1","depends_on_id":"moon-game-studio-a9u.13","type":"parent-child","created_at":"2026-01-27T16:26:52.7718+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.14","title":"render2d/transform: migrate to ECS (no legacy handle stores)","description":"Migrate transform propagation + render2d pipeline to ECS components/resources/queries, removing reliance on legacy handle-based stores and global state.","design":"Follow ./bevy (bevy_transform propagate, render2d extraction/queue). Requires a9u.12 + component/world codegen.","acceptance_criteria":"- Transform hierarchy propagation works on ECS components\\n- render2d uses ECS entities/components for sprites/cameras (extraction/draw)\\n- examples updated to spawn via ECS world\\n- moon test passes","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-27T16:26:19.814205+08:00","created_by":"Milky2018","updated_at":"2026-01-27T18:28:49.095796+08:00","closed_at":"2026-01-27T18:28:49.095796+08:00","close_reason":"Migrated transform propagation + render2d to ECS, updated examples; engine check/test pass.","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-a9u.14","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-27T16:26:19.814915+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-a9u.14","depends_on_id":"moon-game-studio-a9u.12","type":"depends-on","created_at":"2026-01-27T16:26:19.815823+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-a9u.14","depends_on_id":"moon-game-studio-a9u.13","type":"depends-on","created_at":"2026-01-27T16:26:19.816259+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.14.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Start ECS migration","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-27T16:26:52.875386+08:00","created_by":"Milky2018","updated_at":"2026-01-27T16:26:52.875386+08:00","dependencies":[{"issue_id":"moon-game-studio-a9u.14.1","depends_on_id":"moon-game-studio-a9u.14","type":"parent-child","created_at":"2026-01-27T16:26:52.87621+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.15","title":"Chore: clean unused_package warnings after ECS codegen","description":"After switching to #ecs.component/#ecs.resource world codegen, some moon.pkg.json imports are injected but unused (e.g. diagnostics/core, mgstudio/visibility). Decide whether codegen should only add core when required, or adjust packages to actually use the imports; ensure moon check has no unused_package warnings.","acceptance_criteria":"- No unused_package warnings in mgstudio-engine after moon check\\n- Codegen import insertion remains deterministic and JSON-valid","status":"open","priority":3,"issue_type":"chore","owner":"842376130@qq.com","created_at":"2026-01-27T18:30:13.243817+08:00","created_by":"Milky2018","updated_at":"2026-01-27T18:30:13.243817+08:00","dependencies":[{"issue_id":"moon-game-studio-a9u.15","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-27T18:30:13.244536+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.16","title":"cli: switch ECS tag discovery to moonbitlang/parser (no text scanning)","description":"Refactor mgstudio-cli gen to always parse MoonBit sources via moonbitlang/parser and derive #ecs.component/#ecs.resource solely from AST (remove any pre-scan/substring matching).","acceptance_criteria":"- mgstudio-cli no longer scans source text for ecs tags\n- Discovery uses only parser AST attributes\n- moon check passes for mgstudio-cli\n- mgstudio gen output unchanged for existing repo","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-27T19:42:26.359163+08:00","created_by":"Milky2018","updated_at":"2026-01-27T19:53:58.617569+08:00","closed_at":"2026-01-27T19:53:58.617569+08:00","close_reason":"Now always parses sources with moonbitlang/parser@0.1.15; removed tag pre-scan and raw-prefix matching; fixed optional --world-pkg arg; mgstudio gen --check passes.","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-a9u.16","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-27T19:42:26.35998+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.16.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Start refactor","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-27T19:52:39.451658+08:00","created_by":"Milky2018","updated_at":"2026-01-27T19:52:39.451658+08:00","dependencies":[{"issue_id":"moon-game-studio-a9u.16.1","depends_on_id":"moon-game-studio-a9u.16","type":"parent-child","created_at":"2026-01-27T19:52:39.452435+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.2","title":"App/Schedule: run conditions + schedule sets (Bevy parity)","description":"Add Bevy-style run conditions and schedule set APIs needed for example parity (incl. conditional system execution and ordering).","acceptance_criteria":"Can attach run conditions to systems; schedule sets order correctly; basic Bevy patterns used by examples compile and behave as expected.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T12:28:26.104865+08:00","created_by":"Milky2018","updated_at":"2026-01-26T14:17:38.568514+08:00","closed_at":"2026-01-26T14:17:38.568514+08:00","close_reason":"Added run_if + schedule sets ordering (topo sort) with tests","labels":["bevy-parity","engine","schedule"],"dependencies":[{"issue_id":"moon-game-studio-a9u.2","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:26.10587+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.3","title":"Time: FixedTime + fixed update schedule","description":"Implement FixedTime resource and a fixed update schedule that matches Bevy semantics (step accumulation, multiple fixed ticks per frame, etc.).","acceptance_criteria":"Fixed update runs at configured timestep with correct accumulation; API matches Bevy usage patterns; add tests or example verification.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T12:28:28.231176+08:00","created_by":"Milky2018","updated_at":"2026-01-26T14:28:04.810865+08:00","closed_at":"2026-01-26T14:28:04.810865+08:00","close_reason":"Add PreUpdate/FixedUpdate stages + FixedTime accumulator loop with tests","labels":["bevy-parity","engine","time"],"dependencies":[{"issue_id":"moon-game-studio-a9u.3","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:28.232095+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.4","title":"Assets: Handle/AssetId/Assets\u003cT\u003e container + change tracking","description":"Implement core asset containers and handles (Assets\u003cT\u003e, Handle\u003cT\u003e, AssetId), plus change tracking hooks needed by systems. Decoder/loading can stay stubbed.","acceptance_criteria":"Assets\u003cT\u003e supports insert/get/remove; handles are stable and type-safe; change tracking supports system queries; no new external deps.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T12:28:31.296952+08:00","created_by":"Milky2018","updated_at":"2026-01-26T14:35:42.239025+08:00","closed_at":"2026-01-26T14:35:42.239025+08:00","close_reason":"Implement Assets\u003cT\u003e with add/set/remove + AssetEvent change tracking + AssetId + tests","labels":["asset","bevy-parity","engine"],"dependencies":[{"issue_id":"moon-game-studio-a9u.4","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:31.297797+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.5","title":"Render2D: CPU-side sprite batching + sort rules","description":"Implement Bevy-aligned CPU-side batching inputs (z-order, transparency sort key, render layers) to reduce draw-call count; actual GPU submission can remain via existing host API.","acceptance_criteria":"Sprite extraction groups/batches correctly; stable sort matches Bevy rules on examples; measurable draw-call reduction when enabled.","notes":"Implement CPU sprite sorting/batching + WebGPU instanced batching (no ABI change)","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T12:28:33.480073+08:00","created_by":"Milky2018","updated_at":"2026-01-26T15:00:05.871216+08:00","closed_at":"2026-01-26T15:00:05.871216+08:00","close_reason":"Implement sprite batching: engine sorts opaque by texture; web runtime uses instanced draw per texture batch","labels":["bevy-parity","engine","render2d"],"dependencies":[{"issue_id":"moon-game-studio-a9u.5","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:33.481098+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.6","title":"Mesh2D: core data structures (vertices/indices/UV) + CPU validation","description":"Add Mesh2D data structures and helpers (vertex layout, indices, bounds) needed for mesh2d examples. GPU upload can be incremental later.","acceptance_criteria":"Mesh2D types cover mesh2d examples; basic validation (index bounds, attribute lengths) present; example code builds.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T12:28:36.490966+08:00","created_by":"Milky2018","updated_at":"2026-01-26T15:15:17.398871+08:00","closed_at":"2026-01-26T15:15:17.398871+08:00","close_reason":"Implemented Mesh2dGeometry (positions/uvs/indices) + CPU validation + tests.","labels":["bevy-parity","engine","mesh2d"],"dependencies":[{"issue_id":"moon-game-studio-a9u.6","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:36.491808+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.7","title":"render2d: upload Mesh2dGeometry to GPU","description":"Wire Mesh2dGeometry into render2d so users can render arbitrary triangle meshes (CPU-expanded triangle list is OK as a first step).","acceptance_criteria":"render2d exposes an API to create a GPU mesh from Mesh2dGeometry (or from flattened triangle positions); basic validation errors are surfaced; existing mesh2d examples still build.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T15:17:15.749465+08:00","created_by":"Milky2018","updated_at":"2026-01-26T15:39:39.509945+08:00","closed_at":"2026-01-26T15:39:39.509945+08:00","close_reason":"Added gpu_create_mesh_triangles host API and Mesh2d::from_geometry path (validated + CPU-expanded triangles uploaded via CSV string)","labels":["bevy-parity","engine","mesh2d"],"dependencies":[{"issue_id":"moon-game-studio-a9u.7","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T15:17:15.750613+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.8","title":"render2d: add Visibility (Hidden/Visible)","description":"Add Bevy-style Visibility to render2d sprite/mesh. Default bundle visibility is Inherited. Render pass skips Hidden objects. Provide handle-based setters.","design":"See .private/docs/engine/RENDER2D_VISIBILITY.md","acceptance_criteria":"- New Visibility enum exists and is used by SpriteBundle/Mesh2dBundle (default Inherited).\\n- Hidden sprites/meshes are not drawn.\\n- Add an example that toggles visibility via input.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T19:08:23.519656+08:00","created_by":"Milky2018","updated_at":"2026-01-26T19:13:07.8503+08:00","closed_at":"2026-01-26T19:13:07.8503+08:00","close_reason":"Superseded by ECS-based design","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-a9u.8","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T19:08:23.520442+08:00","created_by":"Milky2018"}],"comments":[{"id":86,"issue_id":"moon-game-studio-a9u.8","author":"Milky2018","text":"Superseded: user requested a comprehensive, ECS-based approach (no handle-based store). See .private/docs/engine/ECS_FOUNDATION.md and .private/docs/engine/VISIBILITY_ECS.md. New issues will track the ECS migration.","created_at":"2026-01-26T11:13:06Z"}]}
{"id":"moon-game-studio-a9u.8.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Drafted design in .private/docs; awaiting confirmation before implementation","status":"closed","priority":4,"issue_type":"event","created_at":"2026-01-26T19:08:32.224473+08:00","created_by":"Milky2018","updated_at":"2026-01-26T19:08:32.224473+08:00","closed_at":"2026-01-26T19:08:33.224473+08:00","dependencies":[{"issue_id":"moon-game-studio-a9u.8.1","depends_on_id":"moon-game-studio-a9u.8","type":"parent-child","created_at":"2026-01-26T19:08:32.225206+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-a9u.9","title":"ecs: foundation (Entity, SparseSet, World)","description":"Introduce an ECS foundation aligned with Bevy (Entity with generation, SparseSet component storage, World + minimal resources). This becomes the basis for migrating handle-based stores (render2d/transform/text).","design":"See .private/docs/engine/ECS_FOUNDATION.md","acceptance_criteria":"- Entity allocation/despawn with generation safety\\n- SparseSet storage supports insert/get/remove/iter\\n- World can register/access required components/resources for next tasks\\n- Basic tests","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-26T19:13:19.088355+08:00","created_by":"Milky2018","updated_at":"2026-01-27T15:38:01.796354+08:00","closed_at":"2026-01-27T15:38:01.796354+08:00","close_reason":"Closed","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-a9u.9","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T19:13:19.089206+08:00","created_by":"Milky2018"}],"comments":[{"id":90,"issue_id":"moon-game-studio-a9u.9","author":"Milky2018","text":"Implemented generation-safe Entity allocator + SparseSet[T] + minimal World in mgstudio-engine/core/ecs.mbt, with tests in mgstudio-engine/core/ecs_test.mbt. moon -C mgstudio-engine test passes. Next: add component/resource storage + registration glue to unblock ECS migration of transform/render2d.","created_at":"2026-01-27T06:30:41Z"},{"id":95,"issue_id":"moon-game-studio-a9u.9","author":"Milky2018","text":"Downstream work validated ECS foundation: generated  now composes  +  stores, and App execution passes World into systems. Remaining: Bevy-like change detection / queries / resources as needed for full ECS migration.","created_at":"2026-01-27T07:36:35Z"},{"id":98,"issue_id":"moon-game-studio-a9u.9","author":"Milky2018","text":"Downstream work validated ECS foundation: generated ecs_world.World now composes core.Entities + core.SparseSet stores, and App execution passes World into systems. Remaining: Bevy-like change detection / queries / resources as needed for full ECS migration.","created_at":"2026-01-27T07:36:52Z"},{"id":99,"issue_id":"moon-game-studio-a9u.9","author":"Milky2018","text":"Marking foundation complete for current milestone (Entity+SparseSet+World shell + tests). Follow-up work for resources/change-detection/query tracked in moon-game-studio-a9u.12.","created_at":"2026-01-27T07:38:01Z"}]}
{"id":"moon-game-studio-a9u.9.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Drafting/confirming ECS design before implementation","status":"closed","priority":4,"issue_type":"event","created_at":"2026-01-26T19:13:29.509181+08:00","created_by":"Milky2018","updated_at":"2026-01-26T19:13:29.509181+08:00","closed_at":"2026-01-26T19:13:30.509181+08:00","dependencies":[{"issue_id":"moon-game-studio-a9u.9.1","depends_on_id":"moon-game-studio-a9u.9","type":"parent-child","created_at":"2026-01-26T19:13:29.509845+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-b0w","title":"Native runtime: mgstudio_host.time_now returns seconds but engine expects milliseconds","description":"Engine time code divides (time_now - last_ticks) by 1000 to compute seconds (web semantics). Native runtime time_now currently returns seconds, causing delta_seconds to be 1000x smaller and animations appear frozen.","acceptance_criteria":"- Native mgstudio_host.time_now returns milliseconds (matches web performance.now)\\n- rotation example visibly rotates at expected speed","notes":"Fixed in mgstudio-runtime/native/mbt/time_native.c: time_now now returns monotonic milliseconds (matches web performance.now semantics).","status":"closed","priority":1,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-29T14:33:41.238351+08:00","created_by":"Milky2018","updated_at":"2026-01-29T14:33:49.536367+08:00","closed_at":"2026-01-29T14:33:49.53637+08:00"}
{"id":"moon-game-studio-b3r","title":"Implement render2d camera_system parity with Bevy (viewport + scale factor)","description":"Port Bevy camera_system behavior: maintain computed target info, scale factor, viewport clamp, logical viewport rect conversions, and update render2d_viewport_to_world/world_to_viewport to use logical coords. Align input cursor to logical coordinates and add window scale factor host API.","notes":"Implemented camera_system parity (target size + scale factor, viewport clamp/rescale), logical cursor coordinates, render2d conversions use logical viewport, render pass uses logical size, added host window scale factor API. Pending browser verification of 2d_viewport_to_world.","status":"in_progress","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T09:43:07.689921+08:00","created_by":"Milky2018","updated_at":"2026-01-22T09:58:09.916379+08:00","dependencies":[{"issue_id":"moon-game-studio-b3r","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:52.855748+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-b7n","title":"Engine text: integrate moon_cosmic for shaping/wrap/BiDi (stage 2)","description":"Now that Text2d uses moon_swash for glyph metrics + rasterization in the engine, upgrade layout to moon_cosmic for better parity (wrap/align/BiDi + clustered shaping).\\n\\nScope:\\n- Vendor or add dependency on Milky2018/moon_cosmic (if not published yet).\\n- Replace current per-code-unit layout with cosmic Buffer/layout runs.\\n- Bridge current TextSpan model (per-span font/size/line_height/color) into cosmic AttrsList (may require upstream work or local patch).\\n- Keep render path as atlas-backed sprites (no per-pixel callback).\\n\\nAcceptance:\\n- Word/WordOrGlyph wrap + Align works similar to Bevy.\\n- RTL + mixed-direction text does not reorder incorrectly (basic cases).\\n- No regressions in current Text2d examples.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-31T17:14:11.705286+08:00","created_by":"Milky2018","updated_at":"2026-01-31T20:35:23.1148+08:00","closed_at":"2026-01-31T20:35:23.1148+08:00","close_reason":"Integrated mgstudio/cosmic Buffer/layout_runs into engine text pipeline; added glyph-id raster path and unbounded alignment workaround. Follow-ups: moon-game-studio-h2f (per-span metrics), moon-game-studio-4k7 (subpixel cache)."}
{"id":"moon-game-studio-b8u","title":"Native runtime: sprite UV Y inverted and window size uses logical points causing off-center rendering (Retina)","description":"Running sprite example in native runtime shows the logo flipped vertically and not centered. Likely caused by (1) sprite shader mapping NDC quad t.y directly to UV v without Y inversion, and (2) macOS window width/height returning logical points while engine treats them as physical pixels for surface/viewport; scale_factor then double-applies.","acceptance_criteria":"- Sprite appears upright (no vertical flip)\\n- Sprite appears centered for Transform::identity with Camera2d\\n- window_get_width/height return physical pixel size; input mouse coords remain logical\\n- Verified on Retina scale_factor != 1","notes":"Fix implemented in commit ccd766c: (1) flip sprite UV interpolation Y in native shader; (2) macOS window now tracks logical size for input and returns physical pixel size for window_get_width/height using backingScaleFactor. Please re-run sprite example to verify upright + centered on Retina.","status":"open","priority":1,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-29T14:23:16.490326+08:00","created_by":"Milky2018","updated_at":"2026-01-29T14:28:47.566041+08:00"}
{"id":"moon-game-studio-bag","title":"Refine mgstudio-physics dynamics joints/islands/integration","description":"Implement IslandManager wake/merge behavior, expand ImpulseJointSet graph queries, and start next dynamics module (integration parameters or CCD) aligned with rapier.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T19:18:39.526686+08:00","created_by":"Milky2018","updated_at":"2026-01-21T20:56:38.859507+08:00","closed_at":"2026-01-21T20:56:38.859507+08:00","close_reason":"Closed","labels":["status:done"]}
{"id":"moon-game-studio-bag.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Starting dynamics joint/island/integration work","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-21T19:18:51.305142+08:00","created_by":"Milky2018","updated_at":"2026-01-21T19:18:51.305142+08:00","dependencies":[{"issue_id":"moon-game-studio-bag.1","depends_on_id":"moon-game-studio-bag","type":"parent-child","created_at":"2026-01-21T19:18:51.305871+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-bkg","title":"Implement L1 sprite_scale \u0026 sprite_flipping examples","description":"Add MoonBit examples for sprite_scale and sprite_flipping; hook to runner exports and web menu; ensure build passes.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T11:34:33.352226+08:00","created_by":"Milky2018","updated_at":"2026-01-21T11:34:41.072567+08:00","closed_at":"2026-01-21T11:34:41.072567+08:00","close_reason":"Closed"}
{"id":"moon-game-studio-blf","title":"Native runtime: implement dynamic texture updates for font atlases","description":"Implement/optimize mgstudio_host texture update APIs for native runtime.\n\nScope:\n- asset_update_texture_region(texture_id, x, y, width, height, glyph_id)\n- asset_copy_texture_to_texture(dst_texture_id, dst_x, dst_y, src_texture_id)\n\nNotes:\n- wgpu_mbt currently exposes helper for full texture upload; consider CPU-side backing store for dynamic textures as a bring-up fallback, or extend wgpu_mbt for sub-rect writes.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-28T18:28:55.251276+08:00","created_by":"Milky2018","updated_at":"2026-01-31T17:13:46.943134+08:00","closed_at":"2026-01-31T17:13:46.943134+08:00","close_reason":"Superseded: engine-driven swash pipeline now uploads RGBA bytes via asset_update_texture_region_bytes (native + web)."}
{"id":"moon-game-studio-c6q","title":"Runtime contract: run a single wasm exporting game_app (remove --example/export selection)","description":"We should stop treating engine examples as exports within a runner wasm. The runtime (native + web) must run a single wasm file that exports exactly one entrypoint: game_app.","acceptance_criteria":"- mgstudio-cli run takes a wasm file path and runs game_app only\\n- mgstudio-engine examples are split into per-example packages, each building its own wasm exporting only game_app\\n- mgstudio-runtime/examples provides symlinks to built example wasm(s) or their parent dir\\n- Web runtime loads a selected wasm file and calls game_app (no arbitrary export selection)\\n- Documentation updated","notes":"Completed migration to game_app-only wasm entrypoint across engine examples, native runtime, web runtime, and mgstudio-cli.","status":"closed","priority":0,"issue_type":"epic","owner":"842376130@qq.com","created_at":"2026-01-29T13:28:47.948859+08:00","created_by":"Milky2018","updated_at":"2026-01-29T13:49:02.501531+08:00","closed_at":"2026-01-29T13:49:02.501533+08:00"}
{"id":"moon-game-studio-c6q.1","title":"mgstudio-engine: split examples into per-example packages exporting game_app","description":"Refactor mgstudio-engine/examples so each example is its own MoonBit package and builds to its own wasm-gc artifact. Remove examples/runner aggregator.","acceptance_criteria":"- Each example builds to a separate wasm file under mgstudio-engine/_build/wasm-gc/.../build/examples/...\\n- Each wasm exports only game_app\\n- No runner package required for examples","notes":"Implemented per-example packages under mgstudio-engine/examples/2d/* with wasm-gc exports=[game_app]. Removed examples/runner.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-29T13:28:57.270762+08:00","created_by":"Milky2018","updated_at":"2026-01-29T13:42:49.003128+08:00","closed_at":"2026-01-29T13:42:49.003131+08:00","dependencies":[{"issue_id":"moon-game-studio-c6q.1","depends_on_id":"moon-game-studio-c6q","type":"parent-child","created_at":"2026-01-29T13:28:57.271483+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-c6q.2","title":"mgstudio-cli: mgstudio run \u003cwasm\u003e (remove --example/--export defaults)","description":"Change mgstudio-cli run to require a wasm file path input and always run export game_app. Remove --example and --export options and any implicit sprite default.","acceptance_criteria":"- mgstudio run errors if no wasm path provided\\n- No --example/--export flags\\n- Calls native runtime with wasm path only","notes":"mgstudio run now requires a wasm file path (positional or --wasm) and runs game_app only; removed --example/--export logic and sprite default.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-29T13:29:04.120462+08:00","created_by":"Milky2018","updated_at":"2026-01-29T13:48:42.160061+08:00","closed_at":"2026-01-29T13:48:42.160064+08:00","dependencies":[{"issue_id":"moon-game-studio-c6q.2","depends_on_id":"moon-game-studio-c6q","type":"parent-child","created_at":"2026-01-29T13:29:04.121166+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-c6q.3","title":"Native runtime: always call exported game_app","description":"Update mgstudio-runtime/native to take a wasm path and call game_app only (no export selection).","acceptance_criteria":"- mgstudio-runtime-native.exe \u003cwasm\u003e runs game_app\\n- Clear usage message when wasm path missing\\n- No mention of run_sprite","notes":"Native runtime now takes only \u003cgame.wasm\u003e and calls exported game_app.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-29T13:29:12.537281+08:00","created_by":"Milky2018","updated_at":"2026-01-29T13:48:49.465763+08:00","closed_at":"2026-01-29T13:48:49.465766+08:00","dependencies":[{"issue_id":"moon-game-studio-c6q.3","depends_on_id":"moon-game-studio-c6q","type":"parent-child","created_at":"2026-01-29T13:29:12.53796+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-c6q.4","title":"Web runtime: select wasm file and call game_app","description":"Update mgstudio-runtime/web so it loads a selected wasm file (not runner.wasm) and calls export game_app only.","acceptance_criteria":"- UI / URL selects wasm file\\n- main.mbt calls exports.game_app() only\\n- build.sh builds/copies or symlinks the wasm(s) accordingly","notes":"Web runtime now selects a wasm file (URL param wasm=... or menu data-wasm) and calls exports.game_app only. build.sh builds per-example wasm packages.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-29T13:29:19.270364+08:00","created_by":"Milky2018","updated_at":"2026-01-29T13:47:34.552057+08:00","closed_at":"2026-01-29T13:47:34.55206+08:00","dependencies":[{"issue_id":"moon-game-studio-c6q.4","depends_on_id":"moon-game-studio-c6q","type":"parent-child","created_at":"2026-01-29T13:29:19.271155+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-c6q.5","title":"Examples distribution: mgstudio-runtime/examples symlink layout","description":"Add mgstudio-runtime/examples and symlink built wasm files (or their parent directory). Web runtime should also be able to access this via a symlink under mgstudio-runtime/web.","acceptance_criteria":"- mgstudio-runtime/examples exists and exposes built wasm artifacts\\n- mgstudio-runtime/web/examples points to the same location","notes":"Added symlinks: mgstudio-runtime/examples -\u003e engine _build/.../examples, and mgstudio-runtime/web/examples -\u003e ../examples.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-29T13:29:26.569095+08:00","created_by":"Milky2018","updated_at":"2026-01-29T13:47:41.746931+08:00","closed_at":"2026-01-29T13:47:41.746933+08:00","dependencies":[{"issue_id":"moon-game-studio-c6q.5","depends_on_id":"moon-game-studio-c6q","type":"parent-child","created_at":"2026-01-29T13:29:26.569723+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-c6q.6","title":"Design docs: document game_app-only wasm contract and example packaging","description":"Write/update Chinese design docs under .private/docs for the new contract (game_app only) and example packaging split; include native+web behavior.","acceptance_criteria":"- Docs under .private/docs/runtime, .private/docs/cli, .private/docs/engine updated/added (Chinese)","notes":"Added/updated Chinese design docs for game_app-only wasm entrypoint and per-example packages (runtime/cli/engine).","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-29T13:29:32.798083+08:00","created_by":"Milky2018","updated_at":"2026-01-29T13:47:27.697791+08:00","closed_at":"2026-01-29T13:47:27.697793+08:00","dependencies":[{"issue_id":"moon-game-studio-c6q.6","depends_on_id":"moon-game-studio-c6q","type":"parent-child","created_at":"2026-01-29T13:29:32.798812+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-cd6","title":"wasmoon: string equality in wasm-gc can trap (unreachable)","description":"Repro: compile a wasm-gc module with:\n\n```mbt\npub fn game_app() -\u003e Unit {\n  if \"abc\" == \"\" {\n    ()\n  }\n}\n```\n\nRunning under `Milky2018/wasmoon` interpreter (0.1.3) traps with `runtime error: unreachable`.\n\nDisasm shows equality lowers to a loop over `array.get_u` with `br 2` from nested blocks.\n\nExpected: string equality returns `false`.\n\nSuspect: executor control-flow handling for `br` with depth \u003e 1 (or typed block/loop result values).\n\nWorkaround applied in mgstudio-engine: avoid `String ==` in guest (use `length() == 0` for emptiness).\n","status":"open","priority":2,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-30T23:18:19.030913+08:00","created_by":"Milky2018","updated_at":"2026-01-30T23:19:09.871455+08:00"}
{"id":"moon-game-studio-cgr","title":"Native runtime: implement mgstudio_host.string_sink_push import","description":"runner.wasm now imports mgstudio_host.string_sink_push (used by the Web runtime fallback to reconstruct JS strings when wasm-gc refs are opaque). Native (wasmoon) host should provide this import (can be a no-op initially, later can be wired to a debug logger / string utilities).\\n\\nAcceptance:\\n- Native runtime can instantiate the same runner.wasm without missing import errors.\\n- Implemented host function signature matches (i32 -\u003e unit/i32 depending on toolchain).\\n","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-23T16:32:36.983819+08:00","created_by":"Milky2018","updated_at":"2026-01-25T18:35:40.458006+08:00","closed_at":"2026-01-25T18:35:40.458006+08:00","close_reason":"Implemented mgstudio_host.string_sink_push (no-op) and runner.wasm now instantiates on wasmoon 0.1.3.","dependencies":[{"issue_id":"moon-game-studio-cgr","depends_on_id":"moon-game-studio-953","type":"blocks","created_at":"2026-01-23T17:50:10.689909+08:00","created_by":"Milky2018"}],"comments":[{"id":73,"issue_id":"moon-game-studio-cgr","author":"Milky2018","text":"Implemented a bring-up host stub for mgstudio_host.string_sink_push (no-op, returns 0) in mgstudio-runtime/native/mbt/host_imports.mbt; instantiation verification is blocked by moon-game-studio-953 / wasmoon gh-344.","created_at":"2026-01-23T09:50:11Z"}]}
{"id":"moon-game-studio-djr","title":"Design: unify assets-source \u0026 data-source across web/native (CLI passes, runtime resolves)","status":"closed","priority":1,"issue_type":"task","assignee":"Milky2018","created_at":"2026-01-30T12:32:48.90127+08:00","updated_at":"2026-01-30T12:34:06.657298+08:00","closed_at":"2026-01-30T12:34:06.657298+08:00","close_reason":"Closed","labels":["assets","cli","data","design","runtime"]}
{"id":"moon-game-studio-dpi","title":"Verify L1 sprite_scale \u0026 sprite_flipping in browser","description":"Run web menu, verify sprite_scale and sprite_flipping render correctly in browser; then update  checkboxes once confirmed.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T11:34:18.257868+08:00","created_by":"Milky2018","updated_at":"2026-01-21T11:42:14.575825+08:00","closed_at":"2026-01-21T11:42:14.575825+08:00","close_reason":"Closed"}
{"id":"moon-game-studio-exx","title":"mgstudio-yazi: implement dynamic Huffman blocks (RLE precode + tree optimize)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-23T11:07:25.71885+08:00","updated_at":"2026-01-23T11:59:43.073081+08:00","closed_at":"2026-01-23T11:59:43.073081+08:00","close_reason":"Closed","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-exx","depends_on_id":"moon-game-studio-i0b.1.5","type":"parent-child","created_at":"2026-01-23T11:07:41.381066+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-exx.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Starting upstream parity: dynamic Huffman blocks","status":"closed","priority":4,"issue_type":"event","created_at":"2026-01-23T11:08:03.324569+08:00","created_by":"Milky2018","updated_at":"2026-01-23T11:08:03.324569+08:00","closed_at":"2026-01-23T11:08:04.324569+08:00","dependencies":[{"issue_id":"moon-game-studio-exx.1","depends_on_id":"moon-game-studio-exx","type":"parent-child","created_at":"2026-01-23T11:08:03.32528+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-gdm","title":"Cleanup: deprecate mgstudio_host font_* raster APIs and glyph_id texture updates","description":"After switching Text2d to engine-side moon_swash rasterization, the legacy host font APIs (font_rasterize_glyph/font_measure_advance + glyph_id-based texture updates) are no longer required for core rendering.\\n\\nScope:\\n- Mark mgstudio_host font_* functions as legacy in runtime/web and runtime/native.\\n- Remove or gate engine-side declarations/usages after a transition period.\\n- Consider keeping them only for debugging/fallback (web).\\n- Document the new pipeline: asset_load_font + asset_font_bytes_* + bytes_sink_* + asset_update_texture_region_bytes.\\n\\nAcceptance:\\n- No dead code paths for Text2d in native runtime.\\n- Documentation updated.","status":"open","priority":3,"issue_type":"chore","owner":"842376130@qq.com","created_at":"2026-01-31T17:14:53.096803+08:00","created_by":"Milky2018","updated_at":"2026-01-31T17:14:53.096803+08:00"}
{"id":"moon-game-studio-h1c","title":"Load WGSL shaders from assets in native + web runtimes","description":"Goal: remove embedded WGSL shader sources from runtimes; load shader source from assets files instead.\\n\\nAcceptance Criteria:\\n- mgstudio-runtime/native: no inline WGSL strings for sprite/mesh pipelines; load from assets directory via HostContext assets_source.\\n- mgstudio-runtime/web: no embedded WGSL constants; load shader source via fetch from assets.\\n- mgstudio-page build produces a working dist that includes the required runtime shader assets.\\n\\nNotes:\\n- Keep runtime-specific shaders under an explicit assets subdirectory to avoid clobbering engine shader assets.\\n","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-02-01T17:26:59.083061+08:00","created_by":"Milky2018","updated_at":"2026-02-01T17:35:20.527844+08:00","closed_at":"2026-02-01T17:35:20.527844+08:00","close_reason":"Done","comments":[{"id":108,"issue_id":"moon-game-studio-h1c","author":"Milky2018","text":"Implemented asset-based WGSL loading for native + web runtimes; added runtime shader files under mgstudio-engine/assets/shaders/runtime_{native,web}.","created_at":"2026-02-01T09:35:40Z"}]}
{"id":"moon-game-studio-h2f","title":"Engine text: support per-span font size/line height in cosmic attrs","description":"Current mgstudio-engine cosmic integration uses a single Buffer Metrics (font_size/line_height) for the entire text block. To match bevy/cosmic-text rich text, add per-span metrics support (or an equivalent mechanism) so spans can vary font_size and line_height in one buffer.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-31T20:35:08.157032+08:00","created_by":"Milky2018","updated_at":"2026-01-31T23:21:23.821146+08:00","closed_at":"2026-01-31T23:21:23.821146+08:00","close_reason":"moon_cosmic@0.1.1 adds Attrs::metrics(Metrics); mgstudio-engine now sets per-span font_size/line_height via Attrs.metrics."}
{"id":"moon-game-studio-hnh","title":"moon test fails for mgstudio-runtime/native: generated blackbox_test.c uses undeclared to_string$ symbol","description":"Running tests for mgstudio-runtime/native/mbt fails during C compilation of the generated blackbox test harness. The generated file references an undeclared symbol like to_string3605 (compile-time error: undeclared).","acceptance_criteria":"- moon test -C mgstudio-runtime/native/mbt succeeds (or tests are explicitly disabled with a documented reason)","notes":"Repro:\n- moon test -C mgstudio-runtime/native/mbt\n\nObserved (2026-01-29):\n- mgstudio-runtime/native/mbt/_build/native/debug/test/mgstudio-runtime-native.blackbox_test.c: error: \to_string","status":"open","priority":1,"issue_type":"bug","owner":"842376130@qq.com","created_at":"2026-01-29T13:54:03.569002+08:00","created_by":"Milky2018","updated_at":"2026-01-29T13:54:03.569002+08:00"}
{"id":"moon-game-studio-i0b","title":"Vendor upstream swash/cosmic-text and start MoonBit ports (mgstudio-swash, mgstudio-text)","description":"Clone upstream repos into repo root (ignored), create MoonBit modules mgstudio-swash and mgstudio-text to port swash/cosmic-text. Top priority for Text2d Bevy parity.","status":"in_progress","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T18:35:28.385416+08:00","created_by":"Milky2018","updated_at":"2026-01-22T18:35:38.920621+08:00","comments":[{"id":21,"issue_id":"moon-game-studio-i0b","author":"Milky2018","text":"Done: cloned upstream repos into ./cosmic-text and ./swash (both gitignored). Scaffolded MoonBit modules ./mgstudio-text and ./mgstudio-swash (module names Milky2018/mgstudio_text and Milky2018/mgstudio_swash due to MoonBit name rules). Next: start port by mapping upstream crate modules -\u003e MoonBit subpackages, begin with swash glyph raster (TTF parsing + outline + raster) and cosmic-text Buffer/layout/wrap.","created_at":"2026-01-22T10:40:38Z"},{"id":22,"issue_id":"moon-game-studio-i0b","author":"Milky2018","text":"Created port plan doc: .private/docs/text/PORTING_PLAN.md. Split work into mgstudio-swash (P0) then mgstudio-text (P1) while keeping Bevy pipeline structure.","created_at":"2026-01-22T10:43:51Z"},{"id":23,"issue_id":"moon-game-studio-i0b","author":"Milky2018","text":"Wired local module deps: mgstudio-text now depends on mgstudio-swash via moon.mod.json deps (path ../mgstudio-swash); verified with moon check.","created_at":"2026-01-22T11:01:12Z"},{"id":25,"issue_id":"moon-game-studio-i0b","author":"Milky2018","text":"Renamed module: mgstudio-text -\u003e mgstudio-cosmic (Milky2018/mgstudio_cosmic). Updated local deps/imports and .gitignore.","created_at":"2026-01-22T11:07:14Z"}]}
{"id":"moon-game-studio-i0b.1","title":"Port swash to MoonBit (rasterization core)","description":"Start mgstudio-swash port from ./swash: implement font parsing, glyph outlines, raster to alpha mask, placement offsets. Goal: replace Canvas2D glyph raster in web host.","status":"in_progress","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T18:42:52.397821+08:00","created_by":"Milky2018","updated_at":"2026-01-22T18:43:08.713169+08:00","dependencies":[{"issue_id":"moon-game-studio-i0b.1","depends_on_id":"moon-game-studio-i0b","type":"parent-child","created_at":"2026-01-22T18:42:52.398468+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-i0b.1","depends_on_id":"moon-game-studio-i0b.1.1","type":"blocks","created_at":"2026-01-22T19:36:03.65037+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-i0b.1","depends_on_id":"moon-game-studio-i0b.1.2","type":"blocks","created_at":"2026-01-22T19:44:46.748974+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-i0b.1","depends_on_id":"moon-game-studio-i0b.1.3","type":"blocks","created_at":"2026-01-22T19:52:39.280057+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-i0b.1","depends_on_id":"moon-game-studio-i0b.1.4","type":"blocks","created_at":"2026-01-22T20:00:19.646553+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-i0b.1","depends_on_id":"moon-game-studio-i0b.1.5","type":"blocks","created_at":"2026-01-22T20:00:19.798454+08:00","created_by":"Milky2018"},{"issue_id":"moon-game-studio-i0b.1","depends_on_id":"moon-game-studio-i0b.1.6","type":"blocks","created_at":"2026-01-22T20:00:19.947535+08:00","created_by":"Milky2018"}],"comments":[{"id":24,"issue_id":"moon-game-studio-i0b.1","author":"Milky2018","text":"Design recorded: .private/docs/text/SWASH_PORT.md (TDD-first, P0 scope: internal/parse + raw_data + FontRef/CMAP/glyf/raster). Next implementing internal::parse/raw_data tests \u0026 code.","created_at":"2026-01-22T11:03:49Z"},{"id":27,"issue_id":"moon-game-studio-i0b.1","author":"Milky2018","text":"Ported swash internal parse/raw_data (BeBytes/Stream + raw_data helpers) with MoonBit tests; moon test passes in mgstudio-swash.","created_at":"2026-01-22T11:15:50Z"},{"id":32,"issue_id":"moon-game-studio-i0b.1","author":"Milky2018","text":"Added CacheKey + FontDataRef/FontRef (basic collection support) and internal raw_font table directory helpers (table_range/table_data) with tests; note: RawFont trait can’t be implemented across MoonBit packages, so internal API uses explicit (data, base, tag).","created_at":"2026-01-22T11:27:42Z"},{"id":33,"issue_id":"moon-game-studio-i0b.1","author":"Milky2018","text":"Fix: internal::RawFont should be pub(open) to allow cross-package impl; restored RawFont-based table_range/table_data to match upstream swash.","created_at":"2026-01-22T11:33:01Z"}]}
{"id":"moon-game-studio-i0b.1.1","title":"mgstudio-swash: port cmap/charmap (codepoint-\u003eglyph)","description":"Port swash/src/internal/cmap.rs and swash/src/charmap.rs; add MoonBit tests + fixture font.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:35:50.879257+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:42:56.859021+08:00","closed_at":"2026-01-22T19:42:56.859024+08:00","comments":[{"id":40,"issue_id":"moon-game-studio-i0b.1.1","author":"Milky2018","text":"Implemented internal cmap (subtable/map/enumerate for format 4+12) + swash Charmap/CharmapProxy + synthetic font tests. moon test passes.","created_at":"2026-01-22T11:42:47Z"}]}
{"id":"moon-game-studio-i0b.1.2","title":"mgstudio-swash: port internal fixed/head/xmtx tables","description":"Port swash/src/internal/fixed.rs + head.rs + xmtx.rs (table structs + parsing) with tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:44:36.802969+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:51:25.614925+08:00","closed_at":"2026-01-22T19:51:25.614928+08:00","comments":[{"id":45,"issue_id":"moon-game-studio-i0b.1.2","author":"Milky2018","text":"Ported internal fixed (16.16 math) + head/maxp/hhea/vhea wrappers + xmtx metrics helpers; added tests; moon test passes.","created_at":"2026-01-22T11:51:17Z"}]}
{"id":"moon-game-studio-i0b.1.3","title":"mgstudio-swash: port internal glyf/loca accessors","description":"Port swash/src/internal/glyf.rs (GLYF/LOCA tags, get/ymax) + needed parse Stream helpers + tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:52:24.982144+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:54:54.331546+08:00","closed_at":"2026-01-22T19:54:54.331547+08:00","comments":[{"id":48,"issue_id":"moon-game-studio-i0b.1.3","author":"Milky2018","text":"Ported internal glyf/loca accessors (get/ymax) and extended Stream; added tests; moon test passes.","created_at":"2026-01-22T11:54:54Z"}]}
{"id":"moon-game-studio-i0b.1.4","title":"Port zeno to MoonBit (mgstudio-zeno)","description":"Vendor upstream zeno repo; port types/geometry/raster APIs used by swash (Point/Vector/Transform/Bounds/Verb/Placement/Mask/Scratch/Fill/etc) with tests.","status":"in_progress","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:59:47.635052+08:00","created_by":"Milky2018","updated_at":"2026-01-22T20:00:31.033337+08:00","comments":[{"id":59,"issue_id":"moon-game-studio-i0b.1.4","author":"Milky2018","text":"Bootstrapped mgstudio_zeno + vendored upstream zeno repo; added initial geometry subset (Vector/Point alias, Transform, Origin/Placement/Bounds) and Format enum; tests passing.","created_at":"2026-01-22T12:25:24Z"},{"id":64,"issue_id":"moon-game-studio-i0b.1.4","author":"Milky2018","text":"Design confirmed in .private/docs/swash/ZENO_PORT.md. Next: port raster.rs+mask.rs (fill/alpha first) into mgstudio_zeno with golden pixel tests.","created_at":"2026-01-23T01:44:39Z"},{"id":65,"issue_id":"moon-game-studio-i0b.1.4","author":"Milky2018","text":"Implemented alpha + subpixel/custom-subpixel mask rendering: added Rasterizer::rasterize_write + Mask::render_into subpixel path; added basic triangle tests; docs updated in .private/docs/swash/ZENO_PORT.md. Remaining: Scratch reuse semantics (shared mutable) + stroke.","created_at":"2026-01-23T02:16:09Z"}]}
{"id":"moon-game-studio-i0b.1.4.1","title":"mgstudio-zeno: mask rasterization (fill) subset","description":"Implement zeno Mask/Scratch scan conversion for Alpha/Subpixel formats needed by swash Render; add tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T20:48:39.826642+08:00","created_by":"Milky2018","updated_at":"2026-01-23T10:29:17.902104+08:00","closed_at":"2026-01-23T10:29:17.902104+08:00","close_reason":"Fill mask + subpixel done; stroke tracked separately","dependencies":[{"issue_id":"moon-game-studio-i0b.1.4.1","depends_on_id":"moon-game-studio-i0b.1.4","type":"parent-child","created_at":"2026-01-22T20:48:39.827324+08:00","created_by":"Milky2018"}],"comments":[{"id":66,"issue_id":"moon-game-studio-i0b.1.4.1","author":"Milky2018","text":"Alpha + subpixel/custom-subpixel implemented (RGB channels via rasterize_write) with triangle tests. Remaining: Scratch reuse semantics + stroke (not started).","created_at":"2026-01-23T02:16:11Z"},{"id":67,"issue_id":"moon-game-studio-i0b.1.4.1","author":"Milky2018","text":"Updated Mask::with_scratch to take Ref[Scratch] (closer to Rust \u0026mut Scratch). After rendering, HeapStorage is written back into scratch for allocation reuse. Still missing: scratch.inner bounds/apply cache + stroke.","created_at":"2026-01-23T02:18:00Z"},{"id":68,"issue_id":"moon-game-studio-i0b.1.4.1","author":"Milky2018","text":"Added Mask::render() (allocates buffer, calls render_into) + tests for correct buffer size (alpha/subpixel).","created_at":"2026-01-23T02:22:21Z"},{"id":69,"issue_id":"moon-game-studio-i0b.1.4.1","author":"Milky2018","text":"Added Scratch::apply/bounds wrappers and Mask placement now uses scratch.bounds when provided (closer to upstream scratch path).","created_at":"2026-01-23T02:25:23Z"},{"id":70,"issue_id":"moon-game-studio-i0b.1.4.1","author":"Milky2018","text":"Mask::render_into now routes through scratch.apply(...) when scratch is provided (mirrors upstream control flow; enables future stroke/segments caching without API changes).","created_at":"2026-01-23T02:27:48Z"},{"id":71,"issue_id":"moon-game-studio-i0b.1.4.1","author":"Milky2018","text":"Fill alpha + subpixel/custom-subpixel mask rendering working; Scratch-based entry points wired; tests added. Stroke pipeline tracked separately in moon-game-studio-i0b.1.4.2.","created_at":"2026-01-23T02:29:17Z"}]}
{"id":"moon-game-studio-i0b.1.4.2","title":"mgstudio-zeno: port stroke/segment/dash pipeline","description":"Port zeno/src/stroke.rs + segment.rs (+ minimal deps) into mgstudio_zeno. Keep behavior aligned with upstream (joins/caps/dashes, stroke.scale). Update eval.apply to use stroke when Style::Stroke. Add tests (dash triangle from zeno README) once svg parser exists or build path via commands.","notes":"Merged in worktree zeno-stroke: stroke/segment/dash now implemented; moon test -p zeno passes (commit 01a53e6)","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-23T10:28:59.539543+08:00","created_by":"Milky2018","updated_at":"2026-01-23T11:45:14.374072+08:00","closed_at":"2026-01-23T11:45:14.374074+08:00","dependencies":[{"issue_id":"moon-game-studio-i0b.1.4.2","depends_on_id":"moon-game-studio-i0b.1.4","type":"parent-child","created_at":"2026-01-23T10:28:59.540146+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-i0b.1.4.3","title":"mgstudio-zeno: port svg_parser + traversal + hit_test","description":"Port remaining upstream zeno modules needed by swash/cosmic integration: SVG path parser, traversal (Walk/Vertices), and HitTest.","design":"Follow ./zeno module boundaries and APIs; keep numeric behavior consistent (Double vs f32 documented if needed).","acceptance_criteria":"moon test -p zeno passes; public APIs exist for parsing SVG paths, traversal, and hit testing; behavior matches upstream examples.","notes":"svg_parser + traversal + hit_test implemented; moon test -p zeno passes (commit 01a53e6)","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-23T11:24:33.249402+08:00","created_by":"Milky2018","updated_at":"2026-01-23T11:45:14.555409+08:00","closed_at":"2026-01-23T11:45:14.555411+08:00","dependencies":[{"issue_id":"moon-game-studio-i0b.1.4.3","depends_on_id":"moon-game-studio-i0b.1.4","type":"parent-child","created_at":"2026-01-23T11:24:33.250349+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-i0b.1.5","title":"Port yazi to MoonBit (mgstudio-yazi)","description":"Vendor upstream yazi repo; port PNG/deflate decode APIs used by swash scale/bitmap/png.rs with tests.","status":"in_progress","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:59:58.287378+08:00","created_by":"Milky2018","updated_at":"2026-01-22T20:19:51.572372+08:00","comments":[{"id":60,"issue_id":"moon-game-studio-i0b.1.5","author":"Milky2018","text":"Started mgstudio_yazi port: Format + YaziError + Decoder/DecoderStream + decompress() for stored (BTYPE=00) blocks, with test. Next: fixed + dynamic Huffman.","created_at":"2026-01-22T12:57:43Z"},{"id":62,"issue_id":"moon-game-studio-i0b.1.5","author":"Milky2018","text":"Starting full port of upstream yazi/src/decode.rs: LSB-first bitreader, stored/fixed/dynamic Huffman, zlib header+Adler32. Keep Error model as YaziError.","created_at":"2026-01-22T13:14:12Z"},{"id":63,"issue_id":"moon-game-studio-i0b.1.5","author":"Milky2018","text":"Implemented RFC1950/1951 inflate for mgstudio_yazi: zlib header + stored/fixed/dynamic Huffman decode + Adler32 trailer read. Added zlib test vectors (abc/hello world). moon test passes.","created_at":"2026-01-22T14:15:36Z"},{"id":72,"issue_id":"moon-game-studio-i0b.1.5","author":"Milky2018","text":"Implemented DEFLATE encoder (P1): Stored blocks for NoCompression + Static Huffman (BTYPE=01) with basic LZ77 match finder; zlib wrapper writes Adler32 footer. Added streaming encode tests + size reduction sanity check; moon test passes.","created_at":"2026-01-23T03:00:52Z"}]}
{"id":"moon-game-studio-i0b.1.5.1","title":"mgstudio-yazi: PNG decode for swash bitmap","description":"Implement yazi png decode or port swash/src/scale/bitmap/png.rs dependencies (inflate/zlib/adler) to decode PNG; add tests.","notes":"Starting P1: implement real yazi encode compression (LZ77 + Huffman) per ./yazi/src/encode.rs; design updated in .private/docs/yazi/YAZI_PORT.md","status":"in_progress","priority":0,"issue_type":"task","assignee":"Milky2018","owner":"842376130@qq.com","created_at":"2026-01-22T20:48:41.543282+08:00","created_by":"Milky2018","updated_at":"2026-01-23T10:34:42.435251+08:00","dependencies":[{"issue_id":"moon-game-studio-i0b.1.5.1","depends_on_id":"moon-game-studio-i0b.1.5","type":"parent-child","created_at":"2026-01-22T20:48:41.544083+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-i0b.1.6","title":"Port skrifa to MoonBit (mgstudio-skrifa)","description":"Vendor upstream fontations/skrifa; port the subset used by swash (FontRef, outline_glyphs, hinting interfaces, etc) with tests.","status":"in_progress","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T20:00:07.935511+08:00","created_by":"Milky2018","updated_at":"2026-01-22T21:04:19.031678+08:00","comments":[{"id":61,"issue_id":"moon-game-studio-i0b.1.6","author":"Milky2018","text":"Bootstrapped mgstudio_skrifa packages: instance (Size/NormalizedCoord), font (FontRef skeleton), outline (OutlineGlyphCollection/Hints skeleton) with a basic test. Next: port real skrifa outline + hinting APIs used by swash.","created_at":"2026-01-22T13:04:19Z"}]}
{"id":"moon-game-studio-i0b.1.7","title":"mgstudio-swash: scale/image + scale/outline scaffolding","description":"Port swash/src/scale/image.rs and scale/outline.rs core data structures (Content/Image/Outline/Layer) using mgstudio-zeno types; add tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T20:48:36.504973+08:00","created_by":"Milky2018","updated_at":"2026-01-22T21:02:10.286743+08:00","closed_at":"2026-01-22T21:02:10.286743+08:00","close_reason":"Implemented swash/scale scaffold (Source/StrikeWith + image/outline types + tests)","dependencies":[{"issue_id":"moon-game-studio-i0b.1.7","depends_on_id":"moon-game-studio-i0b.1","type":"parent-child","created_at":"2026-01-22T20:48:36.50566+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-i0b.1.8","title":"mgstudio-swash: OutlineGlyphCollection via skrifa (minimal)","description":"Port minimal subset of skrifa used by swash scale: FontRef::new/from_index + outline_glyphs + OutlinePen draw for glyf; align with swash/src/scale/mod.rs expectations; add tests.","notes":"Per instruction: do not work on skrifa; will implement scale_outline directly from internal glyf/loca for now.","status":"blocked","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T20:48:38.334077+08:00","created_by":"Milky2018","updated_at":"2026-01-23T09:43:01.01425+08:00","dependencies":[{"issue_id":"moon-game-studio-i0b.1.8","depends_on_id":"moon-game-studio-i0b.1","type":"parent-child","created_at":"2026-01-22T20:48:38.334796+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-i0b.2","title":"Port cosmic-text to MoonBit (Buffer/layout/wrap)","description":"Start mgstudio-text port from ./cosmic-text: implement Buffer, shaping/layout pipeline and wrap/justify; integrate with mgstudio-swash for raster.","notes":"All P1.1~P1.5 landed in mgstudio-cosmic; remaining P1.6 integration blocked on mgstudio-swash API stabilization.","status":"blocked","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T18:42:54.336093+08:00","created_by":"Milky2018","updated_at":"2026-01-22T20:21:11.363583+08:00","dependencies":[{"issue_id":"moon-game-studio-i0b.2","depends_on_id":"moon-game-studio-i0b","type":"parent-child","created_at":"2026-01-22T18:42:54.336798+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-i0b.2.1","title":"mgstudio-cosmic MVP: wrap/layout tests (ASCII)","description":"Define minimal cosmic-text-aligned APIs (Metrics, Wrap, LayoutGlyph/LayoutLine) and implement ASCII-only wrap/layout with tests; no shaping yet.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:11:45.612918+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:17:40.135446+08:00","closed_at":"2026-01-22T19:17:40.135446+08:00","close_reason":"MVP wrap/layout tests landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.1","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:11:45.613684+08:00","created_by":"Milky2018"}],"comments":[{"id":26,"issue_id":"moon-game-studio-i0b.2.1","author":"Milky2018","text":"# mgstudio-cosmic MVP 设计（第一步：wrap/layout，ASCII）\n\n目标：在不引入完整 shaping/font fallback 的前提下，先把 `cosmic-text` 的 Buffer/layout “骨架 + 行折行策略”移植出来，并用测试驱动，保证后续替换 shaping 时 API 形状不需要大改。\n\n## 范围（MVP）\n\n- **对齐 upstream 类型命名**：`Metrics`、`Wrap`、`Align`、`LayoutGlyph`、`LayoutLine`。\n- **只做 ASCII 级别布局**（临时）：\n  - `Wrap::None`：不折行\n  - `Wrap::Word`：按空格折行（不做 Unicode word boundary）\n  - `Wrap::WordOrGlyph`：按空格折行，若单词自身超宽则回退到 glyph 折行\n  - `Wrap::Glyph`：按 glyph 折行\n- **glyph advance 临时策略**：用固定宽度（monospace）或测试注入的 advance（后续替换为 swash/cosmic 的 shaping 输出）。\n\n## 非目标（后续阶段）\n\n- 复杂脚本 shaping（harfbuzz）、BiDi、font fallback、字体数据库（fontdb）、以及 swash raster 集成。\n- 完整对齐 `cosmic-text` 的 `FontSystem/ShapeBuffer/ShapeLine` 等运行时结构。\n\n## 测试策略\n\n- 先写测试覆盖 wrap 行为（输入字符串、容器宽度、Wrap 模式 -\u003e 期望的行切分与行宽）。\n- 实现只需满足测试与 API 形状；后续替换 shaping 时保持这些测试不变或扩展（用于防回归）。\n\n## 与 upstream 对齐的约束\n\n- 公共 API 名称/枚举项尽量与 `cosmic-text/src/{buffer.rs,layout.rs}` 一致。\n- 任何与 upstream 不一致的行为（例如：word boundary 规则、空格处理、溢出策略）必须在本文件新增“差异记录”并先确认。\n\n","created_at":"2026-01-22T11:12:17Z"},{"id":28,"issue_id":"moon-game-studio-i0b.2.1","author":"Milky2018","text":"Implemented MVP ASCII wrap/layout slice in mgstudio-cosmic with tests (layout_ascii + Wrap/Align/LayoutGlyph/LayoutLine + Metrics stub). moon test passes.","created_at":"2026-01-22T11:17:30Z"}]}
{"id":"moon-game-studio-i0b.2.10","title":"mgstudio-cosmic: Buffer update flow (P1.2)","description":"Implement Buffer core update flow beyond set_text: per-line AttrsList creation, set_metrics, wrap/hinting setters, redraw semantics; add tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:54:13.938498+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:56:51.830033+08:00","closed_at":"2026-01-22T19:56:51.830033+08:00","close_reason":"Buffer update flow implemented","dependencies":[{"issue_id":"moon-game-studio-i0b.2.10","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:54:13.939106+08:00","created_by":"Milky2018"}],"comments":[{"id":49,"issue_id":"moon-game-studio-i0b.2.10","author":"Milky2018","text":"# mgstudio-cosmic：Buffer 更新流程（P1.2）设计\n\n目标：补齐 `cosmic-text/src/buffer.rs` 中 Buffer 的“更新/重布局/重绘标记”流程，使后续接入 shaping/layout 时接口不需要大改。\n\n## 范围（本阶段）\n\n- 结构字段对齐（逐步补齐）：\n  - `wrap`, `tab_width`, `hinting`, `monospace_width`, `scroll`, `redraw`\n- API（对齐命名/语义，先不引入 FontSystem）：\n  - `Buffer::set_wrap(wrap)`：变更时 `redraw=true`\n  - `Buffer::set_tab_width(tab_width)`：变更时 `redraw=true`\n  - `Buffer::set_hinting(hinting)`：变更时 `redraw=true`\n  - `Buffer::set_monospace_width(width_opt)`：变更时 `redraw=true`\n  - `Buffer::set_metrics(metrics)`：变更时 `redraw=true`（并检查 line_height != 0）\n\n备注：\n- upstream 的 `relayout()` 会在已有 shape 的行上重算 layout；我们当前未实现 shaping/layout，因此此处只做 redraw 标记与字段更新。\n\n","created_at":"2026-01-22T11:55:40Z"},{"id":50,"issue_id":"moon-game-studio-i0b.2.10","author":"Milky2018","text":"Implemented Buffer update-flow setters (set_wrap/set_tab_width/set_hinting/set_monospace_width/set_metrics) with redraw semantics + tests; moon test -p cosmic_text passes.","created_at":"2026-01-22T11:56:51Z"}]}
{"id":"moon-game-studio-i0b.2.11","title":"mgstudio-cosmic: minimal shaping (P1.3)","description":"Implement minimal shaping pipeline for Latin/ASCII (no harfbuzz yet) producing shape runs/glyph advances; keep API aligned with cosmic-text shape.rs; add tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:54:14.422928+08:00","created_by":"Milky2018","updated_at":"2026-01-22T20:02:26.874923+08:00","closed_at":"2026-01-22T20:02:26.874923+08:00","close_reason":"Minimal shaping scaffold landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.11","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:54:14.423596+08:00","created_by":"Milky2018"}],"comments":[{"id":52,"issue_id":"moon-game-studio-i0b.2.11","author":"Milky2018","text":"# mgstudio-cosmic：Shaping（P1.3）设计（对齐 cosmic-text/shape.rs）\n\n目标：实现一个“可用的最小 shaping”，先覆盖 Latin/ASCII 文本，并把数据流形状做成与 upstream 接近，后续再替换为 harfbuzz + font fallback。\n\n## MVP 范围\n\n- 引入 `ShapeGlyph`（对齐字段语义，先做子集）：\n  - `start/end`（cluster range，暂用 code unit index）\n  - `x_advance/x_offset`（Float，单位为 em；MVP 可直接用像素并在 layout 中约定）\n  - `font_id/glyph_id`（MVP 用 Int/Int，占位）\n  - `metadata`（来自 Attrs）\n- 引入 `ShapeLine`：\n  - `glyphs : Array[ShapeGlyph]`\n  - `rtl : Bool`（MVP 固定 false）\n  - `ShapeLine::build(text, attrs_list, shaping, tab_width)`（MVP：1 code unit -\u003e 1 glyph）\n\n## 非目标\n\n- harfbuzz shaping、Unicode script run、BiDi、fontdb、fallback 选择策略\n\n## 与 upstream 差异（已知）\n\n- upstream `glyph_id` 来自字体 shaping；MVP 先用 `code_unit` 值占位\n- upstream 单位换算（em vs px）先简化；后续接入 swash 后再对齐精确度\n\n","created_at":"2026-01-22T11:59:34Z"},{"id":53,"issue_id":"moon-game-studio-i0b.2.11","author":"Milky2018","text":"Implemented minimal shaping scaffold: ShapeGlyph/ShapeLine + BufferLine.shape cache fill (1 code unit -\u003e 1 glyph; tab uses tab_width cells) with tests; moon test -p cosmic_text passes.","created_at":"2026-01-22T12:02:26Z"}]}
{"id":"moon-game-studio-i0b.2.12","title":"mgstudio-cosmic: layout pipeline (P1.4)","description":"Implement layout pipeline producing LayoutLine/LayoutGlyph with align/wrap semantics, aligned with cosmic-text layout.rs/shape.rs; add tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:54:14.921054+08:00","created_by":"Milky2018","updated_at":"2026-01-22T20:12:19.701219+08:00","closed_at":"2026-01-22T20:12:19.701219+08:00","close_reason":"Layout pipeline MVP landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.12","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:54:14.921736+08:00","created_by":"Milky2018"}],"comments":[{"id":54,"issue_id":"moon-game-studio-i0b.2.12","author":"Milky2018","text":"# mgstudio-cosmic：Layout pipeline（P1.4）设计（对齐 cosmic-text/layout.rs + buffer_line.rs）\n\n目标：把 `BufferLine.layout(...) -\u003e \u0026[LayoutLine]` 的数据流跑通，并对齐 `cosmic-text` 的调用形态：\n\n- `BufferLine.shape(...)` 先产出 `ShapeLine`\n- `ShapeLine.layout_to_buffer(...)`（upstream）将结果写入 `LayoutLine/ LayoutGlyph`\n- `BufferLine.layout(...)` 缓存并返回 layout\n\n## MVP 范围\n\n先实现“能驱动 Text2d 的最小 layout”：\n\n- `LayoutGlyph`：补齐最少字段以支持布局与后续 raster/cache_key：\n  - `start/end`（cluster range；MVP 用 code unit index）\n  - `x/y/w`（像素坐标；MVP y=0）\n  - `x_offset/y_offset`（MVP=0）\n  - `metadata`（从 Attrs 继承）\n- `LayoutLine`：\n  - `w`\n  - `glyphs : Array[LayoutGlyph]`\n- `BufferLine.layout(font_size,width_opt,wrap,match_mono_width,tab_width,hinting)`：\n  - 在 `shape_opt` 缓存未准备时先调用 `shape(tab_width)`\n  - 使用 `ShapeGlyph.x_advance` 推导 glyph 的 `x` 与 `w`\n  - `wrap` 行为：复用现有 `layout_ascii` 思路（Word/Glyph/WordOrGlyph），但实现迁移到 `layout_from_shape`（基于 ShapeGlyph）\n  - `hinting`：本阶段只传递，不改变行为（与 `.private/docs/cosmic/BUFFER_METRICS_HINTING_DESIGN.md` 一致）\n\n## 与 upstream 差异（待后续收敛）\n\n- upstream `LayoutGlyph` 字段非常多（font_id/glyph_id/font_size/weight/level/color/cache_key_flags...），MVP 只保留最小集合，后续逐步补齐并保持语义一致。\n- upstream wrap 依赖 Unicode segmentation；当前 P1.1 仅实现 whitespace 分词，后续可替换为 UAX#29。\n\n","created_at":"2026-01-22T12:08:02Z"},{"id":55,"issue_id":"moon-game-studio-i0b.2.12","author":"Milky2018","text":"Implemented MVP layout pipeline: layout_from_shape + BufferLine.layout caching, producing LayoutLine/LayoutGlyph positions and wrap modes (Word/Glyph/WordOrGlyph) using whitespace segmentation; added tests; moon test -p cosmic_text passes.","created_at":"2026-01-22T12:12:19Z"}]}
{"id":"moon-game-studio-i0b.2.13","title":"mgstudio-cosmic: wrap/justify integration (P1.5)","description":"Implement LineBreak/Justify behaviors used by Bevy Text2d alignment; wire into layout; add tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:54:15.402317+08:00","created_by":"Milky2018","updated_at":"2026-01-22T20:18:06.866427+08:00","closed_at":"2026-01-22T20:18:06.866427+08:00","close_reason":"Wrap/justify integration landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.13","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:54:15.402995+08:00","created_by":"Milky2018"}],"comments":[{"id":56,"issue_id":"moon-game-studio-i0b.2.13","author":"Milky2018","text":"# mgstudio-cosmic：Justify / LineBreak（P1.5）设计\n\n目标：补齐 Text2d 需要的对齐与换行策略抽象，并尽量对齐 `cosmic-text` 的 `Align`/`Wrap` 语义与调用方式。\n\n## 1. LineBreak（换行策略）\n\n我们提供 `LineBreak`（面向 Bevy/Text2d），并映射到 cosmic 的 `Wrap`：\n\n- `LineBreak::NoWrap` -\u003e `Wrap::None`\n- `LineBreak::AnyCharacter` -\u003e `Wrap::Glyph`\n- `LineBreak::WordBoundary` -\u003e `Wrap::WordOrGlyph`\n\n备注：upstream cosmic-text 直接用 `Wrap`；这里是为了和引擎侧 API 对齐（属于“适配层”，不改变核心语义）。\n\n## 2. Justify（水平对齐）\n\n我们提供 `Justify`（面向 Bevy/Text2d），并映射到 cosmic 的 `Align`：\n\n- `Justify::Left` -\u003e `Align::Left`\n- `Justify::Right` -\u003e `Align::Right`\n- `Justify::Center` -\u003e `Align::Center`\n- `Justify::Justified` -\u003e `Align::Justified`\n\n## 3. 布局实现\n\n在 `BufferLine.layout(...)` 中：\n\n1) 先按 wrap 生成左对齐的 `LayoutLine/LayoutGlyph`\n2) 若提供了 `width_opt`，再根据 `align` 对 glyph 的 `x` 做二次调整：\n   - `Left`：不变\n   - `Center`：整体平移 `(width - line_w)/2`\n   - `Right/End`：整体平移 `(width - line_w)`\n   - `Justified`：把额外宽度平均分配到该行中的空格 glyph（仅 MVP，后续可对齐 upstream 更复杂规则）\n\n","created_at":"2026-01-22T12:13:57Z"},{"id":57,"issue_id":"moon-game-studio-i0b.2.13","author":"Milky2018","text":"Implemented Justify/LineBreak mapping layer and Align application (Left/Center/Right/End/Justified) via apply_align; BufferLine.layout now applies align when width is provided; added tests; moon test -p cosmic_text passes.","created_at":"2026-01-22T12:18:06Z"}]}
{"id":"moon-game-studio-i0b.2.14","title":"mgstudio-cosmic: integrate with mgstudio-swash (P1.6)","description":"Integrate mgstudio-cosmic shaping/layout output with mgstudio-swash glyph raster/cache_key/placement pipeline; requires mgstudio-swash API stabilization.","notes":"Waiting on mgstudio-swash API stabilization (cache_key/placement/raster)","status":"blocked","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:54:16.931809+08:00","created_by":"Milky2018","updated_at":"2026-01-22T20:19:09.643867+08:00","dependencies":[{"issue_id":"moon-game-studio-i0b.2.14","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:54:16.932582+08:00","created_by":"Milky2018"}],"comments":[{"id":58,"issue_id":"moon-game-studio-i0b.2.14","author":"Milky2018","text":"# mgstudio-cosmic \u003c-\u003e mgstudio-swash 集成（P1.6）设计（待 swash API 稳定）\n\n目标：让 `mgstudio-cosmic` 的 layout 输出能够驱动 `mgstudio-swash` 完成 glyph raster，并与引擎侧 FontAtlasSet 对齐 Bevy 的 Text2d 流程。\n\n## 需要 swash 提供的最小能力（对齐 cosmic-text/swash.rs）\n\n- `CacheKey`：由 (font_id, glyph_id, font_size, subpixel offset, weight, flags...) 生成，作为 atlas cache key\n- `Placement`：glyph 位图在基线坐标系下的放置（left/top/width/height + offsets）\n- `Render`：给定 cache_key/font + glyph_id/size，输出 mask/RGBA bitmap + placement\n\n## cosmic 侧输出（当前已具备）\n\n- `LayoutGlyph`（MVP）：包含 `start/end/x/y/w/x_offset/y_offset/metadata`\n- 后续需要补齐：font_id/glyph_id/font_size/cache_key_flags 等字段，以便无损生成 CacheKey\n\n## 阻塞项\n\n当前 `mgstudio-swash` 仍在 P0.1~P0.5 移植过程中，API 形状未稳定，且工程当前存在编译错误会阻断在 `mgstudio-cosmic` 内直接 import。\n\n## 下一步（依赖 swash 侧）\n\n1) 在 `mgstudio-swash` 明确并稳定 `CacheKey/Placement/Render` API（对齐 upstream swash/cosmic-text）\n2) `mgstudio-cosmic` 补齐 LayoutGlyph 相关字段（font_id/glyph_id/font_size/flags）\n3) 在引擎侧（Text2d）替换 Canvas2D raster，改走 swash raster + atlas\n\n","created_at":"2026-01-22T12:19:49Z"}]}
{"id":"moon-game-studio-i0b.2.2","title":"mgstudio-cosmic: port Cached + LineEnding (+tests)","description":"Port cosmic-text cached.rs and line_ending.rs (LineEnding + LineIter) with MoonBit tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:22:51.544021+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:34:20.640935+08:00","closed_at":"2026-01-22T19:34:20.640935+08:00","close_reason":"cached + line_ending ports landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.2","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:22:51.544741+08:00","created_by":"Milky2018"}],"comments":[{"id":29,"issue_id":"moon-game-studio-i0b.2.2","author":"Milky2018","text":"# mgstudio-cosmic：BufferLine / AttrsList 设计（对齐 cosmic-text）\n\n本文件用于在实现前确认设计，目标是尽可能照搬 `./cosmic-text`（必要时做最小 MoonBit 适配，并记录差异）。\n\n## 1. LineEnding + LineIter\n\n对齐 `cosmic-text/src/line_ending.rs`：\n\n- `LineEnding` 枚举：`Lf | CrLf | Cr | LfCr | None`\n- `LineEnding::as_str()` 返回对应结尾字符串\n- `LineIter`：迭代返回 `(start, end, ending)`，其中 `[start,end)` 是本行内容范围，`ending` 是该行的结尾类型\n- 测试用例与 upstream 相同：`\"LF\\nCRLF\\r\\nCR\\rLFCR\\n\\rNONE\"`\n\n差异：MoonBit 没有 Rust 的 `Range\u003cusize\u003e`，用 `(Int, Int)` 表示 `[start,end)`.\n\n## 2. Cached[T]\n\n对齐 `cosmic-text/src/cached.rs`：\n\n- `Cached[T]`：`Empty | Unused(T) | Used(T)`\n- 需要的 API：\n  - `get() -\u003e T?`（仅 Used 返回 Some）\n  - `is_unused() -\u003e Bool`（Empty/Unused 为 true）\n  - `take_unused() -\u003e (Cached[T], T?)`（函数式风格返回新值；语义与 upstream 一致）\n  - `take_used() -\u003e (Cached[T], T?)`\n  - `set_unused() -\u003e Cached[T]`（Used -\u003e Unused）\n  - `set_used(val) -\u003e Cached[T]`\n\n差异：Rust 是 `\u0026mut self` 原地变更；MoonBit 采用“返回新值”更新（保持语义一致，便于测试与后续替换）。\n\n## 3. Attrs / AttrsList（Span Map）\n\n对齐 `cosmic-text/src/attrs.rs` 的“行为”，但先做最小字段集合以支持 BufferLine：\n\n- `Attrs`：先保留最小字段 `metadata : Int`（后续再逐步补齐 color/weight/style/features 等）\n- `AttrsList`：\n  - `defaults : Attrs`\n  - `spans : Array[AttrsSpan]`（按 start 升序，区间为半开区间 `[start,end)`）\n  - `add_span(start,end,attrs)`：追加一个覆盖范围（MVP 不做 rangemap 合并；后续需要再补）\n  - `get_span(pos)`：返回覆盖 pos 的最后一个 span（无覆盖返回 defaults）\n  - `split_off(index)`：把文本在 index 处分成左右两份，右侧 spans 需要整体 `start/end -= index`\n  - `spans_iter()`：用于 append 复制 spans\n\n差异（待确认）：Rust 使用 `rangemap::RangeMap`，我们 MVP 用“有序 spans 数组 + 线性查询”实现；后续若性能不足再替换为更高效结构，但保持 API 不变。\n\n## 4. BufferLine\n\n对齐 `cosmic-text/src/buffer_line.rs`（核心行为优先）：\n\n- 字段：`text`、`ending`、`attrs_list`、`align`、`shape_opt`、`layout_opt`、`shaping`、`metadata`\n- 行为：\n  - `new(...)`\n  - `reset_new(...)`：复用缓存（MoonBit 版本用 Cached 的 Unused 语义模拟）\n  - `set_text(...) -\u003e Bool`：text/ending/attrs_list 任一变化则 reset 并返回 true\n  - `append(other)`：拼接文本；复制 attrs spans（保留 ending=other.ending）；默认 attrs 不同时需要额外 span\n  - `split_off(index)`：按 index 拆分出新行；原行 ending 变为 None；新行继承 align\n\n差异：同 Cached 一样，Rust 是 \u0026mut self；MoonBit 初版允许用“返回新值”的函数式写法实现（但外部 API 命名/语义对齐）。\n\n","created_at":"2026-01-22T11:23:48Z"},{"id":34,"issue_id":"moon-game-studio-i0b.2.2","author":"Milky2018","text":"Implemented Cached[T] + LineEnding/LineIter ports in mgstudio-cosmic with tests (aligned with cosmic-text/cached.rs + line_ending.rs).","created_at":"2026-01-22T11:34:20Z"}]}
{"id":"moon-game-studio-i0b.2.3","title":"mgstudio-cosmic: port Attrs/AttrsList span map (+tests)","description":"Define Attrs and AttrsList data model close to cosmic-text/attrs.rs; implement minimal span storage + split_off/add_span/get_span, with tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:22:58.872723+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:34:20.857573+08:00","closed_at":"2026-01-22T19:34:20.857573+08:00","close_reason":"AttrsList MVP landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.3","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:22:58.8735+08:00","created_by":"Milky2018"}],"comments":[{"id":30,"issue_id":"moon-game-studio-i0b.2.3","author":"Milky2018","text":"# mgstudio-cosmic：BufferLine / AttrsList 设计（对齐 cosmic-text）\n\n本文件用于在实现前确认设计，目标是尽可能照搬 `./cosmic-text`（必要时做最小 MoonBit 适配，并记录差异）。\n\n## 1. LineEnding + LineIter\n\n对齐 `cosmic-text/src/line_ending.rs`：\n\n- `LineEnding` 枚举：`Lf | CrLf | Cr | LfCr | None`\n- `LineEnding::as_str()` 返回对应结尾字符串\n- `LineIter`：迭代返回 `(start, end, ending)`，其中 `[start,end)` 是本行内容范围，`ending` 是该行的结尾类型\n- 测试用例与 upstream 相同：`\"LF\\nCRLF\\r\\nCR\\rLFCR\\n\\rNONE\"`\n\n差异：MoonBit 没有 Rust 的 `Range\u003cusize\u003e`，用 `(Int, Int)` 表示 `[start,end)`.\n\n## 2. Cached[T]\n\n对齐 `cosmic-text/src/cached.rs`：\n\n- `Cached[T]`：`Empty | Unused(T) | Used(T)`\n- 需要的 API：\n  - `get() -\u003e T?`（仅 Used 返回 Some）\n  - `is_unused() -\u003e Bool`（Empty/Unused 为 true）\n  - `take_unused() -\u003e (Cached[T], T?)`（函数式风格返回新值；语义与 upstream 一致）\n  - `take_used() -\u003e (Cached[T], T?)`\n  - `set_unused() -\u003e Cached[T]`（Used -\u003e Unused）\n  - `set_used(val) -\u003e Cached[T]`\n\n差异：Rust 是 `\u0026mut self` 原地变更；MoonBit 采用“返回新值”更新（保持语义一致，便于测试与后续替换）。\n\n## 3. Attrs / AttrsList（Span Map）\n\n对齐 `cosmic-text/src/attrs.rs` 的“行为”，但先做最小字段集合以支持 BufferLine：\n\n- `Attrs`：先保留最小字段 `metadata : Int`（后续再逐步补齐 color/weight/style/features 等）\n- `AttrsList`：\n  - `defaults : Attrs`\n  - `spans : Array[AttrsSpan]`（按 start 升序，区间为半开区间 `[start,end)`）\n  - `add_span(start,end,attrs)`：追加一个覆盖范围（MVP 不做 rangemap 合并；后续需要再补）\n  - `get_span(pos)`：返回覆盖 pos 的最后一个 span（无覆盖返回 defaults）\n  - `split_off(index)`：把文本在 index 处分成左右两份，右侧 spans 需要整体 `start/end -= index`\n  - `spans_iter()`：用于 append 复制 spans\n\n差异（待确认）：Rust 使用 `rangemap::RangeMap`，我们 MVP 用“有序 spans 数组 + 线性查询”实现；后续若性能不足再替换为更高效结构，但保持 API 不变。\n\n## 4. BufferLine\n\n对齐 `cosmic-text/src/buffer_line.rs`（核心行为优先）：\n\n- 字段：`text`、`ending`、`attrs_list`、`align`、`shape_opt`、`layout_opt`、`shaping`、`metadata`\n- 行为：\n  - `new(...)`\n  - `reset_new(...)`：复用缓存（MoonBit 版本用 Cached 的 Unused 语义模拟）\n  - `set_text(...) -\u003e Bool`：text/ending/attrs_list 任一变化则 reset 并返回 true\n  - `append(other)`：拼接文本；复制 attrs spans（保留 ending=other.ending）；默认 attrs 不同时需要额外 span\n  - `split_off(index)`：按 index 拆分出新行；原行 ending 变为 None；新行继承 align\n\n差异：同 Cached 一样，Rust 是 \u0026mut self；MoonBit 初版允许用“返回新值”的函数式写法实现（但外部 API 命名/语义对齐）。\n\n","created_at":"2026-01-22T11:23:48Z"},{"id":35,"issue_id":"moon-game-studio-i0b.2.3","author":"Milky2018","text":"Implemented MVP Attrs + AttrsList span map (add_span/get_span/split_off/eq) with tests.","created_at":"2026-01-22T11:34:20Z"}]}
{"id":"moon-game-studio-i0b.2.4","title":"mgstudio-cosmic: port BufferLine core (cache reset/append/split_off)","description":"Port cosmic-text/buffer_line.rs core behaviors (set_text/reset/append/split_off) using Cached+LineEnding+AttrsList; cover with tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:23:07.057607+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:34:21.095417+08:00","closed_at":"2026-01-22T19:34:21.095417+08:00","close_reason":"BufferLine MVP landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.4","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:23:07.058299+08:00","created_by":"Milky2018"}],"comments":[{"id":31,"issue_id":"moon-game-studio-i0b.2.4","author":"Milky2018","text":"# mgstudio-cosmic：BufferLine / AttrsList 设计（对齐 cosmic-text）\n\n本文件用于在实现前确认设计，目标是尽可能照搬 `./cosmic-text`（必要时做最小 MoonBit 适配，并记录差异）。\n\n## 1. LineEnding + LineIter\n\n对齐 `cosmic-text/src/line_ending.rs`：\n\n- `LineEnding` 枚举：`Lf | CrLf | Cr | LfCr | None`\n- `LineEnding::as_str()` 返回对应结尾字符串\n- `LineIter`：迭代返回 `(start, end, ending)`，其中 `[start,end)` 是本行内容范围，`ending` 是该行的结尾类型\n- 测试用例与 upstream 相同：`\"LF\\nCRLF\\r\\nCR\\rLFCR\\n\\rNONE\"`\n\n差异：MoonBit 没有 Rust 的 `Range\u003cusize\u003e`，用 `(Int, Int)` 表示 `[start,end)`.\n\n## 2. Cached[T]\n\n对齐 `cosmic-text/src/cached.rs`：\n\n- `Cached[T]`：`Empty | Unused(T) | Used(T)`\n- 需要的 API：\n  - `get() -\u003e T?`（仅 Used 返回 Some）\n  - `is_unused() -\u003e Bool`（Empty/Unused 为 true）\n  - `take_unused() -\u003e (Cached[T], T?)`（函数式风格返回新值；语义与 upstream 一致）\n  - `take_used() -\u003e (Cached[T], T?)`\n  - `set_unused() -\u003e Cached[T]`（Used -\u003e Unused）\n  - `set_used(val) -\u003e Cached[T]`\n\n差异：Rust 是 `\u0026mut self` 原地变更；MoonBit 采用“返回新值”更新（保持语义一致，便于测试与后续替换）。\n\n## 3. Attrs / AttrsList（Span Map）\n\n对齐 `cosmic-text/src/attrs.rs` 的“行为”，但先做最小字段集合以支持 BufferLine：\n\n- `Attrs`：先保留最小字段 `metadata : Int`（后续再逐步补齐 color/weight/style/features 等）\n- `AttrsList`：\n  - `defaults : Attrs`\n  - `spans : Array[AttrsSpan]`（按 start 升序，区间为半开区间 `[start,end)`）\n  - `add_span(start,end,attrs)`：追加一个覆盖范围（MVP 不做 rangemap 合并；后续需要再补）\n  - `get_span(pos)`：返回覆盖 pos 的最后一个 span（无覆盖返回 defaults）\n  - `split_off(index)`：把文本在 index 处分成左右两份，右侧 spans 需要整体 `start/end -= index`\n  - `spans_iter()`：用于 append 复制 spans\n\n差异（待确认）：Rust 使用 `rangemap::RangeMap`，我们 MVP 用“有序 spans 数组 + 线性查询”实现；后续若性能不足再替换为更高效结构，但保持 API 不变。\n\n## 4. BufferLine\n\n对齐 `cosmic-text/src/buffer_line.rs`（核心行为优先）：\n\n- 字段：`text`、`ending`、`attrs_list`、`align`、`shape_opt`、`layout_opt`、`shaping`、`metadata`\n- 行为：\n  - `new(...)`\n  - `reset_new(...)`：复用缓存（MoonBit 版本用 Cached 的 Unused 语义模拟）\n  - `set_text(...) -\u003e Bool`：text/ending/attrs_list 任一变化则 reset 并返回 true\n  - `append(other)`：拼接文本；复制 attrs spans（保留 ending=other.ending）；默认 attrs 不同时需要额外 span\n  - `split_off(index)`：按 index 拆分出新行；原行 ending 变为 None；新行继承 align\n\n差异：同 Cached 一样，Rust 是 \u0026mut self；MoonBit 初版允许用“返回新值”的函数式写法实现（但外部 API 命名/语义对齐）。\n\n","created_at":"2026-01-22T11:23:48Z"},{"id":36,"issue_id":"moon-game-studio-i0b.2.4","author":"Milky2018","text":"Implemented BufferLine MVP (set_text/reset/append/split_off) with tests; uses functional Cached updates.","created_at":"2026-01-22T11:34:20Z"}]}
{"id":"moon-game-studio-i0b.2.5","title":"mgstudio-cosmic: port Buffer core (buffer.rs) + tests","description":"Port cosmic-text/src/buffer.rs core Buffer structure and line management (LineIter split, set_text, set_size, wrap, redraw) with tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:36:53.256654+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:38:57.066528+08:00","closed_at":"2026-01-22T19:38:57.066528+08:00","close_reason":"Buffer MVP landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.5","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:36:53.257371+08:00","created_by":"Milky2018"}],"comments":[{"id":37,"issue_id":"moon-game-studio-i0b.2.5","author":"Milky2018","text":"# mgstudio-cosmic：Buffer 设计（对齐 cosmic-text/buffer.rs）\n\n目标：照搬 `cosmic-text/src/buffer.rs` 的 `Buffer` 核心数据结构与“文本行管理/缓存失效/redraw 标记”语义，先实现可测试的最小闭环，再逐步补齐 shaping/scroll/cursor 等高级功能。\n\n## 1. MVP 范围\n\n- `Buffer` 字段（先做最小集合）：\n  - `lines : Array[BufferLine]`\n  - `metrics : Metrics`\n  - `width_opt : Float?`\n  - `height_opt : Float?`\n  - `redraw : Bool`\n  - `wrap : Wrap`\n  - `tab_width : Int`\n- API（对齐命名/语义）：\n  - `Buffer::new(metrics)` 创建空 buffer\n  - `Buffer::set_size(width_opt,height_opt)` 变更尺寸时设置 `redraw=true`\n  - `Buffer::set_text(text, attrs_list, shaping)` 使用 `LineIter` 拆分成多行 `BufferLine`\n  - `Buffer::lines()` / `Buffer::metrics()` 只读访问\n\n## 2. 非目标（后续阶段）\n\n- `Scroll` / `LayoutRunIter` / `Cursor` / 编辑操作（insert/delete/motion）\n- `monospace_width` / `hinting` 以及 layout pipeline\n- 完整的 `Attrs/Color/FontSystem` 等\n\n## 3. 与 upstream 的差异\n\n- Rust 的 `Vec\u003cBufferLine\u003e` -\u003e MoonBit `Array[BufferLine]`\n- Rust 的 `LineIter` 返回 `Range\u003cusize\u003e` -\u003e MoonBit 返回 `(start,end,ending)`；取子串使用 `StringView::view` + `StringBuilder`（避免直接切片触发 error）\n\n","created_at":"2026-01-22T11:37:28Z"},{"id":38,"issue_id":"moon-game-studio-i0b.2.5","author":"Milky2018","text":"Moved .private/docs/text -\u003e .private/docs/cosmic. Implemented Buffer MVP (set_text line splitting via LineIter, set_size redraw) with tests; moon test -p cosmic_text passes.","created_at":"2026-01-22T11:38:56Z"}]}
{"id":"moon-game-studio-i0b.2.6","title":"mgstudio-cosmic: port Cursor/Affinity/Scroll/Motion (+tests)","description":"Port cosmic-text/src/cursor.rs core types (Cursor, Affinity, LayoutCursor, Motion, Scroll) with tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:40:46.801438+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:42:49.439867+08:00","closed_at":"2026-01-22T19:42:49.439867+08:00","close_reason":"cursor/scroll types landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.6","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:40:46.802192+08:00","created_by":"Milky2018"}],"comments":[{"id":39,"issue_id":"moon-game-studio-i0b.2.6","author":"Milky2018","text":"# mgstudio-cosmic：Cursor/Scroll 设计（对齐 cosmic-text/cursor.rs）\n\n目标：移植 `cosmic-text/src/cursor.rs` 的核心数据结构与语义，为后续 Buffer 编辑、shape/layout、scroll-to-cursor 行为打基础。\n\n## 类型\n\n- `Cursor { line, index, affinity }`\n  - `Cursor::new(line,index)` 默认 `Affinity::Before`\n  - `Cursor::new_with_affinity(line,index,affinity)`\n- `Affinity { Before | After }`\n  - `before()/after()` 判定\n  - `from_before(bool)` / `from_after(bool)`\n- `LayoutCursor { line, layout, glyph }`\n- `Motion`：枚举项与 upstream 保持一致（先移植类型，不实现 motion 行为）\n- `Scroll { line, vertical, horizontal }`\n  - `Scroll::new(line,vertical,horizontal)`\n\n## Buffer 默认值对齐（补充）\n\n我们将 `Buffer::new`/`new_empty` 的默认值对齐 upstream：\n- `redraw=false`\n- `wrap=WordOrGlyph`\n- `tab_width=8`\n- `scroll=Scroll::default()`（0,0,0）\n\n（此处属于“向上游对齐”，不是偏离。）\n\n","created_at":"2026-01-22T11:41:15Z"},{"id":41,"issue_id":"moon-game-studio-i0b.2.6","author":"Milky2018","text":"Ported cursor.rs core types (Cursor/Affinity/LayoutCursor/Motion/Scroll) into mgstudio-cosmic with tests; aligned Buffer defaults (redraw/wrap/tab_width/scroll) to upstream.","created_at":"2026-01-22T11:42:49Z"}]}
{"id":"moon-game-studio-i0b.2.7","title":"mgstudio-cosmic: align Metrics/Hinting/Buffer new_empty API to upstream (+tests)","description":"Port Metrics helpers (relative/scale), Hinting enum, and Buffer::new_empty/wrap/tab_width/hinting defaults closer to cosmic-text/buffer.rs + layout.rs, with tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:45:19.449418+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:49:02.169169+08:00","closed_at":"2026-01-22T19:49:02.169169+08:00","close_reason":"metrics/hinting/buffer defaults aligned","dependencies":[{"issue_id":"moon-game-studio-i0b.2.7","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:45:19.450227+08:00","created_by":"Milky2018"}],"comments":[{"id":42,"issue_id":"moon-game-studio-i0b.2.7","author":"Milky2018","text":"# mgstudio-cosmic：Metrics/Hinting/Buffer 默认值对齐（对齐 cosmic-text）\n\n目标：继续把 `mgstudio-cosmic` 的基础类型与 `cosmic-text` 对齐，减少后续 shape/layout/scroll 迁移时的 API 返工。\n\n## 1. Metrics\n\n对齐 `cosmic-text/src/buffer.rs`：\n\n- `Metrics::new(font_size,line_height)`\n- `Metrics::relative(font_size,line_height_scale)`：`line_height = font_size * line_height_scale`\n- `Metrics::scale(scale)`：同时缩放 font_size 与 line_height\n\n## 2. Hinting\n\n对齐 `cosmic-text/src/layout.rs`：\n\n- `Hinting::Disabled`（默认）\n- `Hinting::Enabled`\n\n（MVP 只移植枚举类型，不实现 hinting 行为。）\n\n## 3. Buffer::new_empty / 默认值\n\n对齐 `cosmic-text/src/buffer.rs::new_empty`：\n\n- 若 `metrics.line_height == 0`：直接失败（upstream panic；MoonBit 用 fail 表达不可恢复错误）\n- 默认值：\n  - `redraw=false`\n  - `wrap=WordOrGlyph`\n  - `tab_width=8`\n  - `scroll=Scroll::default()`\n  - `hinting=Hinting::Disabled`\n  - `monospace_width=None`（后续实现）\n\n差异：\n- 由于当前没有 `FontSystem`，`Buffer::new(font_system, metrics)` 暂不实现，只提供 `new_empty`/`new`（new 调用 new_empty）。\n\n","created_at":"2026-01-22T11:45:52Z"},{"id":43,"issue_id":"moon-game-studio-i0b.2.7","author":"Milky2018","text":"Ported Metrics::relative/scale, added Hinting enum, added Buffer::new_empty with upstream defaults + line_height==0 abort; added tests. moon test -p cosmic_text passes.","created_at":"2026-01-22T11:49:02Z"}]}
{"id":"moon-game-studio-i0b.2.8","title":"mgstudio-cosmic: port Color helpers from attrs.rs (+tests)","description":"Port cosmic-text/src/attrs.rs Color (rgb/rgba/as_rgba/r/g/b/a) with tests; keep Attrs minimal for now.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:50:00.918322+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:51:28.942321+08:00","closed_at":"2026-01-22T19:51:28.942321+08:00","close_reason":"Color port landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.8","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:50:00.918987+08:00","created_by":"Milky2018"}],"comments":[{"id":44,"issue_id":"moon-game-studio-i0b.2.8","author":"Milky2018","text":"# mgstudio-cosmic：Color 设计（对齐 cosmic-text/attrs.rs）\n\n目标：补齐 `cosmic-text/src/attrs.rs` 中最基础且无外部依赖的 `Color` 类型，为后续 Attrs 扩展与渲染集成做准备。\n\n## 类型与 API\n\n- `Color(pub UInt)`（32-bit packed ARGB，与 upstream 一致：`(a\u003c\u003c24)|(r\u003c\u003c16)|(g\u003c\u003c8)|b`）\n- 构造：\n  - `Color::rgb(r,g,b)`（a=0xFF）\n  - `Color::rgba(r,g,b,a)`\n- 访问：\n  - `r()/g()/b()/a() -\u003e Byte`\n  - `as_rgba() -\u003e (Byte,Byte,Byte,Byte)`（返回顺序与 upstream 一致：r,g,b,a）\n\n备注：本阶段不引入 `fontdb`/`rangemap` 等依赖；`Attrs` 仍保持最小字段集合。\n\n","created_at":"2026-01-22T11:50:33Z"},{"id":46,"issue_id":"moon-game-studio-i0b.2.8","author":"Milky2018","text":"Ported Color (rgb/rgba + component accessors) from cosmic-text attrs.rs into mgstudio-cosmic with tests.","created_at":"2026-01-22T11:51:28Z"}]}
{"id":"moon-game-studio-i0b.2.9","title":"mgstudio-cosmic: word boundary + segmentation (P1.1)","description":"Implement word boundary/segmentation utilities used by Wrap/Justify and cursor motion; start with whitespace-based segmentation aligned with current ASCII MVP; add tests.","status":"closed","priority":0,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T19:54:13.432107+08:00","created_by":"Milky2018","updated_at":"2026-01-22T19:58:33.550091+08:00","closed_at":"2026-01-22T19:58:33.550091+08:00","close_reason":"Segmentation MVP landed","dependencies":[{"issue_id":"moon-game-studio-i0b.2.9","depends_on_id":"moon-game-studio-i0b.2","type":"parent-child","created_at":"2026-01-22T19:54:13.432794+08:00","created_by":"Milky2018"}],"comments":[{"id":47,"issue_id":"moon-game-studio-i0b.2.9","author":"Milky2018","text":"# mgstudio-cosmic：Segmentation（P1.1）设计\n\n目标：为 `Wrap::Word` / `Motion::{*Word}` / 文本编辑提供“可用的”单词边界能力，并尽量对齐 `cosmic-text` 使用的 `unicode_segmentation` 行为。\n\n## 现状与限制\n\n- upstream 依赖 `unicode_segmentation::UnicodeSegmentation`（UAX #29 完整实现）。\n- 目前我们没有等价 MoonBit 库可直接使用；完整移植 UAX #29 的成本很高。\n\n## MVP 决策（需确认）\n\n先实现 **Whitespace-based word segmentation**（按空白分词）：\n\n- “word” 定义：连续的非空白 UTF-16 code unit 序列\n- 空白定义：`' '`, `\\\\t`, `\\\\n`, `\\\\r`\n- API：\n  - `word_indices_whitespace(s) -\u003e Array[(start,end)]`（返回每个 word 的 `[start,end)` code unit 范围）\n\n备注：\n- 该实现足以支撑 Bevy/examples/2d 的英文标签与基础交互。\n- 后续如果需要对齐复杂脚本/标点规则，再单独移植 UAX #29（可作为 P1.1.2）。\n\n","created_at":"2026-01-22T11:54:53Z"},{"id":51,"issue_id":"moon-game-studio-i0b.2.9","author":"Milky2018","text":"Implemented whitespace-based word segmentation (word_indices_whitespace) with tests. NOTE: this is a UAX#29 subset; see .private/docs/cosmic/SEGMENTATION_DESIGN.md.","created_at":"2026-01-22T11:58:33Z"}]}
{"id":"moon-game-studio-izv","title":"Native runtime: bring up WGPU backend via wgpu_mbt","description":"Integrate Milky2018/wgpu_mbt into mgstudio-runtime/native so mgstudio_host GPU calls can render sprites/meshes on native (macOS/Metal).","design":"Implement a minimal immediate-mode renderer matching current mgstudio_host API: configure surface, begin/end frame, begin/end pass, draw sprite (textured quad), draw mesh (solid color). Keep APIs compatible with mgstudio-engine/window host imports.","acceptance_criteria":"- mgstudio-runtime/native/mbt compiles with wgpu_mbt dependency\\n- Host GPU imports call into a native backend (no-ops removed)\\n- Document current upstream blockers / missing APIs in README\\n- Identify any wgpu_mbt packaging/API gaps for upstream","status":"in_progress","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-27T20:41:13.958493+08:00","created_by":"Milky2018","updated_at":"2026-01-27T20:43:25.669488+08:00","labels":["status:in_progress"],"comments":[{"id":101,"issue_id":"moon-game-studio-izv","author":"Milky2018","text":"Notes (2026-01-27): wgpu backend code compiles, but  fails when consuming Milky2018/wgpu_mbt@0.1.0 as a dependency because its  uses relative  (-Ivendor/...) and  uses relative  (vendor/.../libwgpu_native.a). Moon appears to run C compilation/linking from the consumer workspace root, so headers/lib aren't found unless a  folder exists there. Workaround: create a local symlink  before building. Upstream fix likely needed (resolve paths relative to package root or make Moon build deps in their own cwd). Also missing API convenience: alpha-blend pipeline with explicit layout or .","created_at":"2026-01-27T12:41:37Z"},{"id":102,"issue_id":"moon-game-studio-izv","author":"Milky2018","text":"Notes (2026-01-27): wgpu backend code compiles, but building/running with Milky2018/wgpu_mbt@0.1.0 fails when used as a dependency because its src/c/moon.pkg.json uses relative stub-cc-flags (-Ivendor/...) and src/moon.pkg.json uses relative cc-link-flags (vendor/.../libwgpu_native.a). Moon appears to run C compilation/linking from the consumer workspace root, so headers/lib are not found unless a vendor/wgpu-native folder exists there. Workaround: create a local symlink \"vendor\" -\u003e \".mooncakes/Milky2018/wgpu_mbt/vendor\" before building. Upstream fix likely needed (resolve paths relative to package root or make Moon build deps in their own cwd). Also missing API convenience: alpha-blend pipeline with explicit layout OR RenderPipeline.get_bind_group_layout.","created_at":"2026-01-27T12:41:52Z"},{"id":103,"issue_id":"moon-game-studio-izv","author":"Milky2018","text":"Tried Milky2018/wgpu_mbt@0.1.1: still fails as dependency.  compiles C stubs with  relative to consumer root and hits . 0.1.1 added a pre-build symlink snippet gated on PWD matching */.mooncakes/*, but dependency builds run with PWD=consumer workspace so it doesn’t execute. Commented upstream in moonbit-community/wgpu-mbt#1.","created_at":"2026-01-28T02:07:00Z"},{"id":104,"issue_id":"moon-game-studio-izv","author":"Milky2018","text":"Tried Milky2018/wgpu_mbt@0.1.1: still fails as dependency. Moon compiles C stubs with -Ivendor/wgpu-native/ffi relative to consumer root and hits wgpu.h file not found. 0.1.1 added a pre-build symlink snippet gated on PWD matching */.mooncakes/*, but dependency builds run with PWD=consumer workspace so it does not execute. Commented upstream in moonbit-community/wgpu-mbt issue #1.","created_at":"2026-01-28T02:07:11Z"},{"id":105,"issue_id":"moon-game-studio-izv","author":"Milky2018","text":"Tried Milky2018/wgpu_mbt@0.1.2: still fails as dependency. C stub compile still uses -Ivendor/wgpu-native/... and errors wgpu.h file not found. 0.1.2 pre-build tries to create vendor/wgpu-native, but seems pre-build does not run before native-stub compilation, so it cannot fix stub includes. Commented upstream in moonbit-community/wgpu-mbt issue #1.","created_at":"2026-01-28T02:33:59Z"},{"id":106,"issue_id":"moon-game-studio-izv","author":"Milky2018","text":"Tried Milky2018/wgpu_mbt@0.1.3: include path problem is addressed via wgpu_native_shim.h vendored include, but registry package fails earlier because src/c/moon.pkg.json lists generated wgpu_native_prebuild.c in native-stub; Moon requires stub inputs to exist when building n2 graph, so pre-build output cannot satisfy it (input missing). With a manual placeholder, link then fails due to missing Objective-C runtime symbols (needs -lobjc and likely frameworks), consistent with wgpu_dyn.c note about dependency link flags not propagating. Commented upstream in moonbit-community/wgpu-mbt issue #1.","created_at":"2026-01-28T05:16:27Z"},{"id":107,"issue_id":"moon-game-studio-izv","author":"Milky2018","text":"Tried Milky2018/wgpu_mbt@0.1.4: consumer build now succeeds (no wgpu.h missing). However runtime dlopen fails because libwgpu_native.dylib is not built/placed automatically; manual `cargo build --release --no-default-features --features metal,wgsl` under `.mooncakes/Milky2018/wgpu_mbt/vendor/wgpu-native` produces `target/release/libwgpu_native.dylib` and lets wgpu-mbt proceed. Also hit wgpu-native validation: surface usage must NOT include texture_binding/RESOURCE; fixed in our GpuBackend::configure_surface.","created_at":"2026-01-28T05:47:46Z"}]}
{"id":"moon-game-studio-j7f","title":"Align mgstudio_physics collision/query/control with rapier semantics","description":"Replace simplified collision detection/resolution and character controller stubs with rapier-accurate broadphase/narrowphase, rotation-aware shapes, and query pipeline behavior.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T09:08:58.397867+08:00","created_by":"Milky2018","updated_at":"2026-01-22T09:08:58.397867+08:00"}
{"id":"moon-game-studio-jkj","title":"Confirm host/web location or relocate","description":"Decide final location for browser host bridge (current: mgstudio-engine/host/web). Move to platform/web or mgstudio-page if needed.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-20T17:47:14.643816+08:00","created_by":"Milky2018","updated_at":"2026-01-20T17:50:58.60998+08:00","closed_at":"2026-01-20T17:50:58.60998+08:00","close_reason":"Moved host bridge to mgstudio-engine/platform/web"}
{"id":"moon-game-studio-jr8","title":"CLI: run uses --platform (-P) web/native, remove native subcommand and --wasm flag","status":"closed","priority":1,"issue_type":"task","assignee":"Milky2018","created_at":"2026-01-30T11:14:16.746569+08:00","updated_at":"2026-01-30T11:19:39.42166+08:00","closed_at":"2026-01-30T11:19:39.42166+08:00","close_reason":"Closed","labels":["cli","run"]}
{"id":"moon-game-studio-jvj","title":"Allow switching examples via reload param","description":"When an example is running, clicking another example reloads with ?run=... and auto-runs it.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T12:35:41.807953+08:00","created_by":"Milky2018","updated_at":"2026-01-21T12:36:09.935495+08:00","closed_at":"2026-01-21T12:36:09.935495+08:00","close_reason":"Closed"}
{"id":"moon-game-studio-lc3","title":"cli: add local install script (symlink mgstudio into ~/.local/bin)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T14:12:42.119163+08:00","updated_at":"2026-01-27T14:14:22.595259+08:00","closed_at":"2026-01-27T14:14:22.595259+08:00","close_reason":"Closed","labels":["status:in_progress"],"comments":[{"id":89,"issue_id":"moon-game-studio-lc3","author":"Milky2018","text":"Added scripts/mgstudio-install to install a PATH symlink (default  or ~/.local/bin) pointing to the repo mgstudio wrapper; wrapper now resolves symlinks so it works when installed.","created_at":"2026-01-27T06:13:58Z"}]}
{"id":"moon-game-studio-ljh","title":"Runtime core: parse source specs, normalize paths, block traversal (.., absolute)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-30T12:45:50.243825+08:00","updated_at":"2026-01-30T13:34:59.556603+08:00","closed_at":"2026-01-30T13:34:59.556603+08:00","close_reason":"Closed","labels":["assets","data","runtime","security"],"dependencies":[{"issue_id":"moon-game-studio-ljh","depends_on_id":"moon-game-studio-rog","type":"parent-child","created_at":"2026-01-30T12:48:07.889778+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-lvq","title":"Rewrite web runtime loader in MoonBit (mizchi/js)","notes":"Implemented MoonBit runtime loader (mizchi/js), updated build.sh to build JS runtime, main.js now loads compiled runtime output.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-21T17:00:21.161346+08:00","updated_at":"2026-01-21T17:27:04.720112+08:00","closed_at":"2026-01-21T17:27:04.720114+08:00"}
{"id":"moon-game-studio-m0q","title":"Align IslandManager sleep/optimizer traversal to rapier","description":"Port IslandManager sleep extraction, optimizer splitting/merging, and traversal behavior to match rapier island_manager/*; update wake-up semantics and ContactGraph integration.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T10:40:39.708997+08:00","created_by":"Milky2018","updated_at":"2026-01-22T10:43:33.499318+08:00","closed_at":"2026-01-22T10:43:33.499318+08:00","close_reason":"done"}
{"id":"moon-game-studio-my1","title":"Refine IslandManager traversal/optimizer alignment","description":"Align IslandManager sleep traversal, merge/split optimizer, and add whitebox tests following rapier island_manager/*.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T11:58:19.577848+08:00","created_by":"Milky2018","updated_at":"2026-01-22T11:58:44.656557+08:00","closed_at":"2026-01-22T11:58:44.656557+08:00","close_reason":"done"}
{"id":"moon-game-studio-obj","title":"Native sprite: PNG alpha not blended (black box background)","status":"closed","priority":1,"issue_type":"bug","assignee":"Milky2018","created_at":"2026-01-29T15:12:03.097602+08:00","updated_at":"2026-01-29T15:21:18.414883+08:00","closed_at":"2026-01-29T15:21:18.414883+08:00","close_reason":"Closed","labels":["native","render","sprite"]}
{"id":"moon-game-studio-q66","title":"Implement 2d_viewport_to_world example","description":"Add simplified 2d_viewport_to_world example (mouse to world -\u003e sprite follow; arrow keys move camera). No viewport/zoom yet. Hook to runner exports and web menu. After browser verification, update  and ROADMAP_PHASE1.md.","notes":"Add host_debug_string throttle log for primary camera in 2d_viewport_to_world example.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T12:22:50.109274+08:00","created_by":"Milky2018","updated_at":"2026-01-26T17:30:13.834792+08:00","closed_at":"2026-01-26T17:30:13.834792+08:00","close_reason":"Closed","comments":[{"id":7,"issue_id":"moon-game-studio-q66","author":"Milky2018","text":"Updated 2d_viewport_to_world example to use Gizmos (circles) and SystemParam wiring; needs browser verification after gizmo rendering.","created_at":"2026-01-22T04:26:02Z"},{"id":10,"issue_id":"moon-game-studio-q66","author":"Milky2018","text":"Added a green Mesh2d marker and dashed viewport outline in 2d_viewport_to_world to visualize input/viewport interactions; uses GizmoConfig line style switch for dashed border.","created_at":"2026-01-22T05:14:46Z"}]}
{"id":"moon-game-studio-qvz","title":"Implement WebGPU clear pass in JS host","description":"Add minimal render pass submission in host/web/host.js (clear color) and drive it from window runner.","status":"closed","priority":1,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-20T17:47:08.027731+08:00","created_by":"Milky2018","updated_at":"2026-01-20T17:50:51.365924+08:00","closed_at":"2026-01-20T17:50:51.365924+08:00","close_reason":"Implemented clear pass in WebGPU host"}
{"id":"moon-game-studio-r86","title":"Milestone 2 design: texture atlas + sprite animation (Bevy parity)","description":"Draft design in .private/docs/engine (Chinese). Align with Bevy texture_atlas/sprite_sheet/sprite_animation APIs. Update ROADMAP references.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T15:06:36.744651+08:00","created_by":"Milky2018","updated_at":"2026-01-22T15:06:36.744651+08:00","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-r86","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:53.207166+08:00","created_by":"Milky2018"}],"comments":[{"id":12,"issue_id":"moon-game-studio-r86","author":"Milky2018","text":"Drafted .private/docs/engine/MILESTONE2_PLAN.md. Pending confirmation: host-side TextureAtlasBuilder, skipping text labels for texture_atlas, and load_folder strategy.","created_at":"2026-01-22T07:18:04Z"},{"id":13,"issue_id":"moon-game-studio-r86","author":"Milky2018","text":"Updated MILESTONE2_PLAN: Text2d moved into milestone 2, load_folder + AssetEvent aligned to Bevy. Pending confirmation: Text2d implementation path (host rasterize -\u003e sprite) vs full glyph atlas now.","created_at":"2026-01-22T07:23:30Z"},{"id":14,"issue_id":"moon-game-studio-r86","author":"Milky2018","text":"User confirmed: Text2d must be implemented now with full glyph atlas (no whole-text texture). Docs updated to reflect glyph atlas + AssetEvent + LoadedFolder.","created_at":"2026-01-22T07:28:44Z"},{"id":15,"issue_id":"moon-game-studio-r86","author":"Milky2018","text":"Added .private/docs/engine/TEXT2D.md with Bevy-aligned text pipeline and updated MILESTONE2_PLAN/ROADMAP_PHASE1 accordingly.","created_at":"2026-01-22T07:34:23Z"}]}
{"id":"moon-game-studio-r86.1","title":"State change: status → in_progress","description":"Set status to in_progress","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-22T15:06:51.917936+08:00","created_by":"Milky2018","updated_at":"2026-01-22T15:06:51.917936+08:00","dependencies":[{"issue_id":"moon-game-studio-r86.1","depends_on_id":"moon-game-studio-r86","type":"parent-child","created_at":"2026-01-22T15:06:51.918604+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-r86.2","title":"Implement Text2d pipeline (Bevy parity)","description":"Port bevy_text pipeline structures, Text2d/TextSpan components, font atlas set, glyph caching, and update_text2d_layout system.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T15:37:41.825553+08:00","created_by":"Milky2018","updated_at":"2026-01-22T15:37:41.825553+08:00","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-r86.2","depends_on_id":"moon-game-studio-r86","type":"parent-child","created_at":"2026-01-22T15:37:41.826225+08:00","created_by":"Milky2018"}],"comments":[{"id":16,"issue_id":"moon-game-studio-r86.2","author":"Milky2018","text":"Updated text pipeline scaffolding (CosmicBuffer/span ranges, text measurement stub), added Justify::Justified + TextLayout::with_* helpers, removed self-labeled Assets methods; moon check passes with warnings.","created_at":"2026-01-22T08:34:53Z"},{"id":17,"issue_id":"moon-game-studio-r86.2","author":"Milky2018","text":"Implemented DynamicTextureAtlasBuilder + FontAtlas/FontAtlasSet scaffolding and host glyph rasterization/atlas update APIs; updated .private docs for glyph cache host signatures.","created_at":"2026-01-22T09:02:03Z"},{"id":18,"issue_id":"moon-game-studio-r86.2","author":"Milky2018","text":"Added text layout pipeline scaffolding with glyph rasterization, FontAtlasSet integration, and render2d glyph sprite submission (uv-based). Layout uses simple code-unit flow; pending Bevy parity/shaping.","created_at":"2026-01-22T09:46:56Z"},{"id":20,"issue_id":"moon-game-studio-r86.2","author":"Milky2018","text":"Drafted design for Text2d shaping/layout backend: host_text_layout JSON API implemented by browser Canvas2D; engine keeps Bevy pipeline structure. See .private/docs/engine/TEXT2D_LAYOUT_BACKEND.md (needs review/confirmation due to cosmic-text deviation).","created_at":"2026-01-22T09:57:57Z"},{"id":84,"issue_id":"moon-game-studio-r86.2","author":"Milky2018","text":"Text2d pipeline now renders via glyph atlas + render2d overlay sprites; added font-loaded gating + rerender-on-missing-glyph, shadow rendering, and a web-verifiable example (run_text2d) using FiraSans-Bold.ttf.","created_at":"2026-01-26T10:32:28Z"},{"id":85,"issue_id":"moon-game-studio-r86.2","author":"Milky2018","text":"Improved Text2d layout without external deps: added font_measure_advance host API, whitespace/tab handling, simple max_width wrapping, and horizontal justify (left/center/right). Updated Text2d example to demonstrate wrapping+centering.","created_at":"2026-01-26T10:58:11Z"}]}
{"id":"moon-game-studio-r86.2.1","title":"State change: status → in_progress","description":"Set status to in_progress","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-22T15:38:18.730213+08:00","created_by":"Milky2018","updated_at":"2026-01-22T15:38:18.730213+08:00","dependencies":[{"issue_id":"moon-game-studio-r86.2.1","depends_on_id":"moon-game-studio-r86.2","type":"parent-child","created_at":"2026-01-22T15:38:18.730864+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-r86.3","title":"Implement font atlas + dynamic texture atlas builder","description":"Port bevy_image dynamic_texture_atlas_builder and glyph atlas update logic; integrate with asset/image handles.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T15:37:49.219966+08:00","created_by":"Milky2018","updated_at":"2026-01-26T18:28:13.411499+08:00","closed_at":"2026-01-26T18:28:13.411499+08:00","close_reason":"Implemented TextureAtlasBuilder blit path + web host support; verified via texture_atlas_builder example","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-r86.3","depends_on_id":"moon-game-studio-r86","type":"parent-child","created_at":"2026-01-22T15:37:49.220718+08:00","created_by":"Milky2018"}],"comments":[{"id":83,"issue_id":"moon-game-studio-r86.3","author":"Milky2018","text":"Implemented TextureAtlasBuilder::try_build/build with auto-growing atlas size (256→2048 by default), new host APIs (asset_texture_width/height, asset_is_texture_loaded, asset_copy_texture_to_texture) and WebGPU COPY_SRC support for blitting. Added example run_texture_atlas_builder + unit tests for DynamicTextureAtlasBuilder.","created_at":"2026-01-26T10:22:32Z"}]}
{"id":"moon-game-studio-r86.3.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Start implementing TextureAtlasBuilder (multi-texture atlas) and required host APIs","status":"closed","priority":4,"issue_type":"event","created_at":"2026-01-26T18:12:15.485168+08:00","created_by":"Milky2018","updated_at":"2026-01-26T18:12:15.485168+08:00","closed_at":"2026-01-26T18:12:16.485168+08:00","dependencies":[{"issue_id":"moon-game-studio-r86.3.1","depends_on_id":"moon-game-studio-r86.3","type":"parent-child","created_at":"2026-01-26T18:12:15.485764+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-r86.4","title":"Implement asset load_folder + LoadedFolder + AssetEvent","description":"Add asset events for LoadedFolder and integrate with host async loading. Align with Bevy asset events.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T15:37:55.575864+08:00","created_by":"Milky2018","updated_at":"2026-01-26T16:06:27.797738+08:00","closed_at":"2026-01-26T16:06:27.797738+08:00","close_reason":"Integrated AssetServer::load_folder with host async loading; added LoadedFolder events + polling in asset_system; implemented web host manifest-based folder loading.","dependencies":[{"issue_id":"moon-game-studio-r86.4","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:53.536596+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-r86.5","title":"Add render2d atlas UV + host APIs for glyph/textures","description":"Extend host draw_sprite with UVs, add asset_load_bytes/create_dynamic_texture/update_texture_region, and render glyph quads.","status":"in_progress","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T15:38:02.381179+08:00","created_by":"Milky2018","updated_at":"2026-01-26T17:40:43.311101+08:00","dependencies":[{"issue_id":"moon-game-studio-r86.5","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:53.88256+08:00","created_by":"Milky2018"}],"comments":[{"id":19,"issue_id":"moon-game-studio-r86.5","author":"Milky2018","text":"Added gpu_draw_sprite_uv path with UV rect support; sprite pipeline now uses UVs and uniform buffer expanded to include uv min/scale.","created_at":"2026-01-22T09:47:11Z"},{"id":81,"issue_id":"moon-game-studio-r86.5","author":"Milky2018","text":"Implemented engine-side atlas UV helpers + sprite atlas setters (uv_min/uv_max on SpriteInstance) and updated font raster host ABI to avoid wasm-gc host→wasm String returns (now returns glyph_id + metric getters). Dynamic texture atlas builder / texture update host APIs still pending.","created_at":"2026-01-26T09:57:51Z"}]}
{"id":"moon-game-studio-r86.6","title":"Update 2d examples: sprite_sheet/sprite_animation/texture_atlas","description":"Implement examples with Text2d labels and atlas animation. Verify in browser.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T15:38:11.446349+08:00","created_by":"Milky2018","updated_at":"2026-01-27T18:29:50.060819+08:00","closed_at":"2026-01-27T18:29:50.060819+08:00","close_reason":"Updated 2d examples to ECS-based spawn + TextureAtlas component insertion; project compiles and moon test passes.","dependencies":[{"issue_id":"moon-game-studio-r86.6","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:54.444969+08:00","created_by":"Milky2018"}],"comments":[{"id":82,"issue_id":"moon-game-studio-r86.6","author":"Milky2018","text":"Added 2D examples: sprite_sheet, sprite_animation (cycles atlas index), texture_atlas (manual rects). Wired runner exports + web index buttons. Pending: verify these examples in browser; Text2d labels intentionally omitted until Text2d pipeline is ready.","created_at":"2026-01-26T09:57:52Z"}]}
{"id":"moon-game-studio-rby","title":"Align ImpulseJointSet API with rapier graph/enable semantics","description":"Implement joint_graph exposure, enabled/disabled joint state, select_active_interactions, and align attached_joints signatures to rapier where feasible. Update tests accordingly.","notes":"Implemented JointEnabled + ImpulseJoint enable toggling, joint_graph snapshot, enabled filtering, and tests; islands now use enabled joints.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T16:50:37.263048+08:00","created_by":"Milky2018","updated_at":"2026-01-22T17:08:52.142058+08:00","closed_at":"2026-01-22T17:08:52.14206+08:00"}
{"id":"moon-game-studio-rdl","title":"Align joint removal wake/join dedup to rapier","description":"Update multibody joint removal to wake connected bodies and clear mappings; ensure wake/join queues dedupe and pipeline behavior matches rapier.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T11:08:28.048117+08:00","created_by":"Milky2018","updated_at":"2026-01-22T11:26:05.530194+08:00","closed_at":"2026-01-22T11:26:05.530194+08:00","close_reason":"done"}
{"id":"moon-game-studio-rnf","title":"mgstudio-swash: implement Scaler.scale_outline via glyf (simple glyph)","description":"Implement TrueType simple glyph outline extraction in mgstudio-swash/swash/scale/context.mbt using internal glyf/loca/head; add unit tests with synthetic glyph data; keep API aligned with upstream swash where possible; document deviation from skrifa.","notes":"Implemented Scaler.scale_outline for TrueType simple glyf (direct parsing, temporary deviation from upstream skrifa-based outline). Tests added.","status":"in_progress","priority":0,"issue_type":"task","assignee":"Milky2018","owner":"842376130@qq.com","created_at":"2026-01-23T09:43:01.569995+08:00","created_by":"Milky2018","updated_at":"2026-01-23T09:53:29.576764+08:00"}
{"id":"moon-game-studio-rog","title":"Implement unified assets-source and data-source across CLI + runtimes","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-30T12:42:42.900625+08:00","updated_at":"2026-01-30T13:35:10.553208+08:00","closed_at":"2026-01-30T13:35:10.553208+08:00","close_reason":"Closed","labels":["assets","cli","data","runtime"]}
{"id":"moon-game-studio-sai","title":"Web runtime: viewport_to_world example doesn't receive keyboard input","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-24T00:10:55.671796+08:00","updated_at":"2026-01-25T00:02:37.635355+08:00","closed_at":"2026-01-25T00:02:37.635355+08:00","close_reason":"Fixed: any_to_string now supports string-sink fallback for opaque wasm-gc String objects; input key code strings decode correctly without js-builtin-string.","comments":[{"id":74,"issue_id":"moon-game-studio-sai","author":"Milky2018","text":"Cause: web host never calls init_input(), so no keydown/keyup listeners are registered; only pointer events are bound. Fix: call init_input(state) during window_create.","created_at":"2026-01-23T16:11:03Z"},{"id":75,"issue_id":"moon-game-studio-sai","author":"Milky2018","text":"Follow-up diagnosis: when not using js-builtin-string, guest passes MoonBit String as wasm-gc array ref; in the current browser this arrives as a null-prototype opaque object, so host input functions calling any_to_string() returned empty string (String(obj) throws). Fix: add the same string-sink fallback (mgstudio_host_string_to_js + mgstudio_host.string_sink_push) to any_to_string(), so input key code strings decode correctly.","created_at":"2026-01-24T16:02:19Z"}]}
{"id":"moon-game-studio-si5","title":"L2 examples: 2d_viewport_to_world + pixel_grid_snap","description":"Design + implement 2d_viewport_to_world and pixel_grid_snap examples. Update .private/docs with design before implementation. Keep parity with Bevy; confirm deviations.","notes":"Fix: create window/GPU before startup so startup systems can read window size (viewport_to_world visibility). Added note in HOST_INTERFACE.md.","status":"closed","priority":2,"issue_type":"task","assignee":"Milky2018","owner":"842376130@qq.com","created_at":"2026-01-21T20:33:01.941538+08:00","created_by":"Milky2018","updated_at":"2026-01-26T17:32:19.927158+08:00","closed_at":"2026-01-26T17:32:19.927158+08:00","close_reason":"Closed"}
{"id":"moon-game-studio-svl","title":"Fix web menu reload + drop wasm backend config","description":"Allow reload button after example run; remove wasm backend configuration from moon.pkg.json; update .private docs to mention wasm-gc only.","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T12:32:55.714351+08:00","created_by":"Milky2018","updated_at":"2026-01-21T12:33:05.730947+08:00","closed_at":"2026-01-21T12:33:05.730947+08:00","close_reason":"Closed"}
{"id":"moon-game-studio-ukx","title":"Verify mesh2d example in browser","description":"Run mesh2d example in browser (WASM-GC) and confirm rectangle renders with correct color/scale.","status":"closed","priority":3,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T14:02:13.442604+08:00","created_by":"Milky2018","updated_at":"2026-01-26T17:30:13.833641+08:00","closed_at":"2026-01-26T17:30:13.833641+08:00","close_reason":"Closed","dependencies":[{"issue_id":"moon-game-studio-ukx","depends_on_id":"moon-game-studio-a9u","type":"parent-child","created_at":"2026-01-26T12:28:55.821537+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-v7g","title":"ecs: codegen concrete World + component access traits","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-27T14:44:06.193079+08:00","updated_at":"2026-01-27T15:38:11.485693+08:00","closed_at":"2026-01-27T15:38:11.485693+08:00","close_reason":"Closed","labels":["status:in_progress"],"dependencies":[{"issue_id":"moon-game-studio-v7g","depends_on_id":"moon-game-studio-a9u.9","type":"blocks","created_at":"2026-01-27T14:44:16.287819+08:00","created_by":"Milky2018"}],"comments":[{"id":91,"issue_id":"moon-game-studio-v7g","author":"Milky2018","text":"Design drafted: .private/docs/engine/ECS_CODEGEN_WORLD.md (World codegen + Has_* access traits). Next: implement mgstudio gen to emit a concrete World package (e.g. ecs_world/ecs_world.g.mbt) and Has_* traits based on #ecs.component.","created_at":"2026-01-27T06:45:22Z"},{"id":93,"issue_id":"moon-game-studio-v7g","author":"Milky2018","text":"Implemented mgstudio-cli world codegen:  now emits  with Has_* traits + World struct (Entities + SparseSet per component). Added  on  and ensured generated outputs are stable under  (gen -c passes).","created_at":"2026-01-27T07:36:31Z"},{"id":96,"issue_id":"moon-game-studio-v7g","author":"Milky2018","text":"Implemented mgstudio-cli world codegen: mgstudio gen --world-pkg \u003cdir\u003e emits ecs_world.g.mbt with Has_* traits + World struct (Entities + SparseSet per component). Added #ecs.component on mgstudio-engine/math/Transform and ensured generated outputs are stable under moon fmt (gen -c passes).","created_at":"2026-01-27T07:36:48Z"}]}
{"id":"moon-game-studio-wby","title":"Shader asset layout: separate engine/runtime builtin shaders from game shaders","description":"Problem:\n- We currently store backend-specific builtin shaders under mgstudio-engine/assets/shaders/runtime_{web,native}/ and runtimes hardcode loading shaders/runtime_{web,native}/*.wgsl.\n- This makes shaders look runtime-specific, and it paper-cuts engine-led rendering parity: Web and Native bring-up pipelines diverge and require shader forks.\n\nTarget outcome:\n- Treat all shaders as regular assets loaded from assets-source.\n- Engine owns the stable shader + bind group/buffer layout conventions (Bevy-aligned); runtime implements the host WebGPU backend without introducing shader forks.\n- Define stable paths for engine builtin shaders under shaders/mgstudio/... (e.g. shaders/mgstudio/2d/sprite.wgsl).\n\nNotes:\n- If Web and Native need different WGSL, treat that as a bring-up regression and fix the runtime/pipeline implementation instead.\n","acceptance_criteria":"- Engine builtin shaders are treated as assets and loaded via assets-source (no runtime-owned shader directories).\n- No runtime code refers to paths under shaders/runtime_web/* or shaders/runtime_native/*.\n- A single WGSL implementation is used across Web + Native for sprite/mesh/gizmo pipelines (differences are fixed in bring-up, not via shader forks).\n- Asset paths use a stable convention under shaders/mgstudio/...\n","status":"closed","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-02-01T17:45:43.165379+08:00","created_by":"Milky2018","updated_at":"2026-02-01T18:54:15.2063+08:00","closed_at":"2026-02-01T18:54:15.2063+08:00","close_reason":"Implemented canonical shader assets under shaders/mgstudio and updated Web+Native runtimes to load them (no runtime_* shader paths)."}
{"id":"moon-game-studio-x93","title":"Native mesh pipeline: add alpha blending + surface-format-aware pipeline descriptors for pos2","description":"Problem:\n- Native runtime mesh pipeline currently uses a pos2-only pipeline descriptor that does not enable alpha blending and may not respect the configured surface format.\n\nGoal:\n- Provide a wgpu pipeline descriptor (or helper) for pos2 vertex buffers with alpha blending and explicit color format (similar to Web runtime).\n\nNotes:\n- Prefer solving this upstream in Milky2018/wgpu_mbt (e.g. a new desc_builders helper like render_pipeline_descriptor_color_format_alpha_blend_pos2_new), then consume it here.\n- Do not vendor dependencies.","status":"open","priority":2,"issue_type":"task","created_at":"2026-02-01T18:54:58.550239+08:00","updated_at":"2026-02-01T18:55:06.840166+08:00"}
{"id":"moon-game-studio-xux","title":"Fix mgstudio_physics testbed blackbox wasm compile error in moon test","description":"Investigate testbed blackbox wasm compile error during moon test; fix or adjust testbed package/tests.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-21T19:45:48.966186+08:00","created_by":"Milky2018","updated_at":"2026-01-21T19:46:32.122004+08:00","labels":["status:done"]}
{"id":"moon-game-studio-xux.1","title":"State change: status → done","description":"Set status to done","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-21T20:20:08.446144+08:00","created_by":"Milky2018","updated_at":"2026-01-21T20:20:08.446144+08:00","dependencies":[{"issue_id":"moon-game-studio-xux.1","depends_on_id":"moon-game-studio-xux","type":"parent-child","created_at":"2026-01-21T20:20:08.446672+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-xxm","title":"Align ImpulseJointSet/IslandManager graph semantics with rapier","description":"Refine impulse joint graph handling, handle validity, and island mappings to match rapier dynamics semantics; add coverage for joint set behaviors.","status":"open","priority":2,"issue_type":"task","owner":"842376130@qq.com","created_at":"2026-01-22T09:29:59.919965+08:00","created_by":"Milky2018","updated_at":"2026-01-22T09:29:59.919965+08:00","labels":["status:done"]}
{"id":"moon-game-studio-xxm.1","title":"State change: status → in_progress","description":"Set status to in_progress\n\nReason: Implementing rapier-aligned impulse joint/island behavior","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-22T09:30:19.393148+08:00","created_by":"Milky2018","updated_at":"2026-01-22T09:30:19.393148+08:00","dependencies":[{"issue_id":"moon-game-studio-xxm.1","depends_on_id":"moon-game-studio-xxm","type":"parent-child","created_at":"2026-01-22T09:30:19.393828+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-xxm.2","title":"State change: status → done","description":"Changed status from in_progress to done\n\nReason: Implemented rapier-aligned impulse joint set behavior and tests","status":"open","priority":4,"issue_type":"event","created_at":"2026-01-22T09:30:59.389933+08:00","created_by":"Milky2018","updated_at":"2026-01-22T09:30:59.389933+08:00","dependencies":[{"issue_id":"moon-game-studio-xxm.2","depends_on_id":"moon-game-studio-xxm","type":"parent-child","created_at":"2026-01-22T09:30:59.390633+08:00","created_by":"Milky2018"}]}
{"id":"moon-game-studio-y54","title":"Cleanup: remove vendored mgstudio-runtime/native/wasmoon directory (now using registry dep)","description":"mgstudio-runtime/native 已改为使用 registry 依赖 Milky2018/wasmoon@0.1.3，但仓库中仍残留旧的 vendored 目录：mgstudio-runtime/native/wasmoon。\n\n目标：\n- 评估是否保留（patch/对照），否则从仓库移除或改成 submodule/subtree。\n- 确认不会影响 moon 依赖解析与构建。","notes":"已清理：从仓库移除 vendored 目录 mgstudio-runtime/native/wasmoon（依赖已使用 registry Milky2018/wasmoon@0.1.3）。","status":"closed","priority":3,"issue_type":"chore","created_at":"2026-01-30T14:22:49.796956+08:00","updated_at":"2026-01-30T14:31:03.588387+08:00","closed_at":"2026-01-30T14:31:03.588389+08:00","labels":["cleanup","deps","native"]}
{"id":"moon-game-studio-zie","title":"Legal/docs: add cosmic-text attribution when distributing cosmic-derived code","description":"We vendored a MoonBit port of cosmic-text logic into mgstudio-engine/cosmic. Ensure license/attribution requirements for cosmic-text (MIT OR Apache-2.0) are met in repo docs/credits when distributing.","status":"open","priority":3,"issue_type":"chore","owner":"842376130@qq.com","created_at":"2026-01-31T20:35:08.634128+08:00","created_by":"Milky2018","updated_at":"2026-01-31T20:35:08.634128+08:00"}
{"id":"moon-game-studio-zoj","title":"Refactor runtime layout: flatten web/mbt -\u003e web and native/mbt -\u003e native","status":"closed","priority":1,"issue_type":"task","assignee":"Milky2018","created_at":"2026-01-29T15:27:19.185765+08:00","updated_at":"2026-01-29T15:36:27.083024+08:00","closed_at":"2026-01-29T15:36:27.083024+08:00","close_reason":"Closed","labels":["layout","refactor","runtime"]}
